<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Python è£…é¥°å™¨è¯¦è§£ | FdxCauponağŸ</title><meta name="author" content="Fed_Dragon"><meta name="copyright" content="Fed_Dragon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="è£…é¥°å™¨åœ¨Pythonä¸­ååˆ†æœ‰ç”¨ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä½¿å¾—ç¬¬ä¸€ä¸ªå‚æ•°åªèƒ½æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–è€…ç±»ã€‚æœ¬ç¯‡æ–‡ç« å°†è¯¦ç»†è§£æè£…é¥°å™¨çš„ä½¿ç”¨æ–¹æ³• + ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨è£…é¥°å™¨ã€‚ è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿè®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´ç°åœ¨å‡è®¾è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘éœ€è¦è®¡æ—¶å¹¶æ‰“å°å‡ºä»»ä½•ä¸€ä¸ªå‡½æ•°çš„è¿è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®ç°ï¼š 1234567import timedef timer(func, *args, **kwargs):    t1 &#x3D; time">
<meta property="og:type" content="article">
<meta property="og:title" content="Python è£…é¥°å™¨è¯¦è§£">
<meta property="og:url" content="https://www.fdxblog.tk/2022/11/28/Python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="FdxCauponağŸ">
<meta property="og:description" content="è£…é¥°å™¨åœ¨Pythonä¸­ååˆ†æœ‰ç”¨ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä½¿å¾—ç¬¬ä¸€ä¸ªå‚æ•°åªèƒ½æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–è€…ç±»ã€‚æœ¬ç¯‡æ–‡ç« å°†è¯¦ç»†è§£æè£…é¥°å™¨çš„ä½¿ç”¨æ–¹æ³• + ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨è£…é¥°å™¨ã€‚ è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿè®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´ç°åœ¨å‡è®¾è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘éœ€è¦è®¡æ—¶å¹¶æ‰“å°å‡ºä»»ä½•ä¸€ä¸ªå‡½æ•°çš„è¿è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®ç°ï¼š 1234567import timedef timer(func, *args, **kwargs):    t1 &#x3D; time">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.fdxblog.tk/img/cover1.webp">
<meta property="article:published_time" content="2022-11-28T10:23:30.000Z">
<meta property="article:modified_time" content="2022-12-05T04:12:28.179Z">
<meta property="article:author" content="Fed_Dragon">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="è£…é¥°å™¨">
<meta property="article:tag" content="functools">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.fdxblog.tk/img/cover1.webp"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.fdxblog.tk/2022/11/28/Python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python è£…é¥°å™¨è¯¦è§£',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-05 12:12:28'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style>@font-face{font-family:'zhuziawan';font-style:normal;font-weight:400;src:url(https://conf.totoro.pub/fonts/zhuziawan/zhuziawan.woff2) format("woff2")}</style><meta name="generator" content="Hexo 6.3.0"></head><body><link rel="stylesheet" href="/css/barber-shop.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-newspaper"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover1.webp'); backdrop-filter: blur(2px)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">FdxCauponağŸ</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-newspaper"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python è£…é¥°å™¨è¯¦è§£</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-11-28T10:23:30.000Z" title="å‘è¡¨äº 2022-11-28 18:23:30">2022-11-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-12-05T04:12:28.179Z" title="æ›´æ–°äº 2022-12-05 12:12:28">2022-12-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python è£…é¥°å™¨è¯¦è§£"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>è£…é¥°å™¨åœ¨Pythonä¸­ååˆ†æœ‰ç”¨ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä½¿å¾—ç¬¬ä¸€ä¸ªå‚æ•°åªèƒ½æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–è€…ç±»ã€‚æœ¬ç¯‡æ–‡ç« å°†è¯¦ç»†è§£æè£…é¥°å™¨çš„ä½¿ç”¨æ–¹æ³• + ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨è£…é¥°å™¨ã€‚</p>
<h2 id="è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><h3 id="è®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´"><a href="#è®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´" class="headerlink" title="è®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´"></a>è®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´</h3><p>ç°åœ¨å‡è®¾è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘éœ€è¦è®¡æ—¶å¹¶æ‰“å°å‡ºä»»ä½•ä¸€ä¸ªå‡½æ•°çš„è¿è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®ç°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">timer</span>(<span class="params">func, *args, **kwargs</span>):</span><br><span class="line">    t1 = time.perf_counter()</span><br><span class="line">    func(*args, **kwargs)</span><br><span class="line">    t2 = time.perf_counter()</span><br><span class="line">    <span class="built_in">print</span>(t2 - t1)</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ª<code>timer</code>å‡½æ•°ï¼Œå‚æ•°åˆ—è¡¨æ˜¯ä¸€ä¸ªå‡½æ•°å’Œè¯¥å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚ç„¶ååœ¨å‡½æ•°è¿è¡Œå‰åè·å–æ—¶é—´ï¼Œå¹¶æ‰“å°å·®å€¼ã€‚<br>è¦ä½¿ç”¨è¿™ä¸ªå‡½æ•°ä¹Ÿå¾ˆç®€å•ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sleep_n</span>(<span class="params">n</span>):</span><br><span class="line">    time.sleep(n)</span><br><span class="line"></span><br><span class="line">timer(sleep_n, <span class="number">5</span>)    <span class="comment"># 5.000540600000022</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™æ ·å¾ˆä¸‘ï¼Œæ¯ä¸€æ¬¡è®¡æ—¶éƒ½éœ€è¦æ˜¾ç¤ºè°ƒç”¨<code>timer</code>å‡½æ•°ï¼Œå¦‚æœæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è®©æ¯ä¸€æ¬¡è°ƒç”¨<code>sleep_n(5)</code>éƒ½è¾“å‡ºè°ƒç”¨æ—¶é—´å°±å¥½äº†ã€‚æ”¹è¿›äº†ä¹‹åçš„ä»£ç å¯èƒ½é•¿è¿™æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">timer</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        t1 = time.perf_counter()</span><br><span class="line">        func(*args, **kwargs)</span><br><span class="line">        t2 = time.perf_counter()</span><br><span class="line">        <span class="built_in">print</span>(t2 - t1)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡<code>timer</code>å‡½æ•°åªæ¥å—ä¸€ä¸ªCallableå¯¹è±¡ï¼Œä½¿å¾—<code>wrapper</code>å‡½æ•°å¯ä»¥é€šè¿‡é—­åŒ…è¯»å–åˆ°<code>func</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯<code>wrapper</code>å‡½æ•°ä¼šæœ‰å¾ˆå¤šä»½â€”â€”æ¯ä¸€æ¬¡è°ƒç”¨<code>timer</code>éƒ½ä¼šæ–°åˆ›å»ºè¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€æ¬¡è¿”å›çš„å€¼æ˜¯ä¸åŒçš„å‡½æ•°å¯¹è±¡è€ŒéåŒä¸€ä»½ï¼ˆ<code>timer(f) is not timer(f)</code>ï¼‰<br>æ›´æ”¹äº†<code>timer</code>ï¼Œè‡ªç„¶ä¹Ÿéœ€è¦æ›´æ”¹ä½¿ç”¨æ–¹æ³•ï¼Œè¿™æ¬¡å…ˆæ­å»ºå¥½äº†<code>sleep_n</code>å‡½æ•°ä¹‹åæŠŠå‡½æ•°ç›´æ¥ä¼ ç»™<code>timer</code>å†èµ‹å€¼ç»™<code>sleep_n</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sleep_n</span>(<span class="params">n</span>):</span><br><span class="line">    time.sleep(n)</span><br><span class="line"></span><br><span class="line">sleep_n = timer(sleep_n)</span><br><span class="line">sleep_n(<span class="number">5</span>)    <span class="comment"># 5.0063890999999785</span></span><br></pre></td></tr></table></figure>
<p>è¿™å°±å¯¼è‡´äº†è¿™ä¸ªå‡½æ•°è™½ç„¶è¿˜å«<code>sleep_n</code>ï¼Œä½†æ˜¯å…¶æŒ‡å‘çš„å¯¹è±¡å´è¢«æ”¹æˆäº†è¿™ä¸ª<code>wrapper</code>å‡½æ•°ï¼Œåœ¨è°ƒç”¨<code>sleep_n(5)</code>çš„æ—¶å€™å®é™…ä¸Šæ˜¯è°ƒç”¨äº†<code>timer</code>å‡½æ•°å†…<code>wrapper</code>æŒ‡å‘çš„å‡½æ•°å¯¹è±¡ã€‚ä¸ä¸¥è°¨çš„è¯´ï¼Œå°±æ˜¯è°ƒç”¨äº†<code>wrapper(5)</code>ï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥äº†æ—¶é•¿ã€‚<br>ä½†æ˜¯è¿™ä¹ˆå†™è¿˜æ˜¯å¾ˆä¸‘ï¼Œéœ€è¦ä¸€ç§æ–¹æ³•ä¸“é—¨åšåˆ°åˆ›å»º(<code>sleep_n</code>)å‡½æ•°ï¼Œè°ƒç”¨ç›®æ ‡(<code>timer</code>)å‡½æ•°ï¼Œç„¶åå†èµ‹å€¼ä¼šåŸæ¥çš„å‡½æ•°(<code>sleep_n = timer(sleep_n)</code>)ï¼Œè€Œè£…é¥°å™¨å°±ç”±æ­¤è€Œç”Ÿäº†ï¼Œä¸Šé¢çš„ä»£ç ç”¨è£…é¥°å™¨çš„å†™æ³•å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sleep_n</span>(<span class="params">n</span>):</span><br><span class="line">    time.sleep(n)</span><br><span class="line"></span><br><span class="line">sleep_n(<span class="number">1</span>)    <span class="comment"># 1.0079503999995723</span></span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ä¸éš¾çœ‹å‡ºæ¥ï¼Œè£…é¥°å™¨(<code>@xxx def x</code>)çš„æ•ˆæœå°±æ˜¯<code>x = xxx(x)</code>ï¼Œå’Œä¸Šé¢è¯´çš„ä¸€æ ·ï¼Œåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–æ¥ç®€åŒ–â€create, pipe, assignâ€è¿™ä¸‰ä¸ªæ­¥éª¤çš„ã€‚äº‹å®ä¸Šä¸Šé¢ä¸¤ä¸ªä»£ç å—é‡Œå…³äº<code>sleep_n</code>å‡½æ•°çš„å¤„ç†æ˜¯å®Œå…¨ç­‰ä»·çš„ã€‚</p>
<h3 id="ç»™å‡½æ•°æ·»åŠ å±æ€§"><a href="#ç»™å‡½æ•°æ·»åŠ å±æ€§" class="headerlink" title="ç»™å‡½æ•°æ·»åŠ å±æ€§"></a>ç»™å‡½æ•°æ·»åŠ å±æ€§</h3><p>æ—¢ç„¶è£…é¥°å™¨éœ€è¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°è¾“å…¥ï¼Œé‚£æˆ‘ä»¬è‡ªç„¶ä¹Ÿå¯ä»¥ä¿®æ”¹æˆ–è€…å¢åŠ è¿™ä¸ªå‡½æ•°çš„å±æ€§ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">stamp</span>(<span class="params">func</span>):</span><br><span class="line">    func.stamped = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="meta">@stamp</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> test.stamped:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ·»åŠ å±æ€§æˆåŠŸï¼&quot;</span>)    <span class="comment"># æ·»åŠ å±æ€§æˆåŠŸï¼</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œ<code>@stamp</code>è£…é¥°å™¨è¿”å›çš„è¿˜æ˜¯åŸæ¥é‚£ä¸ªå‡½æ•°ï¼Œåªæ˜¯åŠ¨æ€æ·»åŠ äº†ä¸€ä¸ªå±æ€§<code>stamped</code>ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥ç”¨åœ¨åˆ¤æ–­å†…ã€‚è¿™ä¸ªâ€é»‘é­”æ³•â€œåœ¨æŠ½è±¡ç±»ABCä¸­æœ‰å¹¿æ³›ä½¿ç”¨ï¼Œè¯¦è§<a href="/2022/11/18/Python-Metaclass%E4%B8%8E%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/">å…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹</a>ã€‚</p>
<h2 id="æ›´é«˜çº§çš„è£…é¥°å™¨"><a href="#æ›´é«˜çº§çš„è£…é¥°å™¨" class="headerlink" title="æ›´é«˜çº§çš„è£…é¥°å™¨"></a>æ›´é«˜çº§çš„è£…é¥°å™¨</h2><h3 id="functools-wrapsè£…é¥°å™¨è£…é¥°è£…é¥°å™¨"><a href="#functools-wrapsè£…é¥°å™¨è£…é¥°è£…é¥°å™¨" class="headerlink" title="functools.wrapsè£…é¥°å™¨è£…é¥°è£…é¥°å™¨(?)"></a><code>functools.wraps</code>è£…é¥°å™¨è£…é¥°è£…é¥°å™¨(?)</h3><p>è¿˜æ˜¯ä»¥å‰é¢çš„<code>timer</code>è£…é¥°å™¨ä¸¾ä¾‹å­ï¼Œå‡è®¾æˆ‘ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">timer</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        t1 = time.perf_counter()</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        t2 = time.perf_counter()</span><br><span class="line">        <span class="built_in">print</span>(t2 - t1)</span><br><span class="line">        <span class="keyword">return</span> ret    <span class="comment"># ç¡®ä¿å°†è¿”å›å€¼å†è¿”å›å›å»</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†ä¸¤ä¸ªå‚æ•°ç›¸åŠ &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># ç”¨æ—¶ï¼š2.9000002541579306e-06</span></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š3</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨é—®é¢˜å‡ºç°äº†ï¼Œç”±äº<code>timer</code>è£…é¥°å™¨è¿”å›çš„<code>wrapper</code>å‡½æ•°æ›¿ä»£äº†<code>add</code>å‡½æ•°ï¼ˆè™½ç„¶è¿˜å«addï¼‰ï¼Œå°è¯•å»è¯»å–docstringå’Œå…¶ä»–ä¸€äº›å…ƒä¿¡æ¯çš„æ—¶å€™ä¼šå˜æˆå…¶ä»–çš„ä¿¡æ¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†ä¸¤ä¸ªå‚æ•°ç›¸åŠ &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add.__doc__, add.__name__)    <span class="comment"># None wrapper</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†ä¸¤ä¸ªå‚æ•°ç›¸åŠ &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add.__doc__, add.__name__)    <span class="comment"># å°†ä¸¤ä¸ªå‚æ•°ç›¸åŠ  add</span></span><br></pre></td></tr></table></figure>
<p>æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå…¶å®Pythonå†…ç½®çš„<code>functools.wraps</code>è£…é¥°å™¨å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">timer</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @functools.wraps(<span class="params">func</span>)    </span><span class="comment"># â€åŒ…è£…äº†â€œfuncå‡½æ•°</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        t1 = time.perf_counter()</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        t2 = time.perf_counter()</span><br><span class="line">        <span class="built_in">print</span>(t2 - t1)</span><br><span class="line">        <span class="keyword">return</span> ret    <span class="comment"># ç¡®ä¿å°†è¿”å›å€¼å†è¿”å›å›å»</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>
<p><code>functools.wraps</code>ä¼šå°†ä¼ è¿›å»çš„<code>func</code>å‡½æ•°çš„å…ƒä¿¡æ¯ï¼ˆåŒ…æ‹¬<code>__module__</code>, <code>__name__</code>, <code>__qualname__</code>, <code>__annotations__</code>, å’Œ <code>__doc__</code>ï¼‰æ›¿æ¢æ‰<code>wrapper</code>å‡½æ•°çš„è¿™äº›å±æ€§ï¼Œé¡ºä¾¿å°†<code>func.__dict__</code>ï¼ˆå®ä¾‹å­—å…¸ï¼‰ä¹ŸåŒæ­¥åˆ°<code>wrapper</code>ä¸Šï¼Œæ‰€ä»¥ä¸‹é¢çš„ä»£ç å¾—ä»¥æˆç«‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">stamp</span>(<span class="params">func</span>):</span><br><span class="line">    func.__stamped__ = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="meta">@stamp</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(add.__stamped__)    <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>)    <span class="comment"># 1.2299999980314169e-05</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºï¼š</p>
<ol>
<li>é¦–å…ˆå¤šä¸ªè£…é¥°å™¨è£…é¥°ä¸€ä¸ªå‡½æ•°ä¼šä»ä¸‹å¾€ä¸Šå¥—ï¼Œæ ¹æ®è¯­æ³•ç³–<code>@timer @stamp def add</code>ç­‰åŒäº<code>add = timer(stamp(add))</code>ï¼Œæ‰€ä»¥ä¼šå…ˆè¿›è¡Œ<code>stamp(add)</code></li>
<li>åœ¨<code>stamp</code>è£…é¥°å™¨å†…å°†<code>__stamped__</code>å±æ€§èµ‹å€¼ï¼Œè€Œè¿™ä¸ªå±æ€§æ˜¯å­˜åœ¨äºè¢«ä¼ è¿›æ¥çš„<code>func</code>ï¼ˆä¹Ÿå°±æ˜¯<code>add</code>ï¼‰çš„å®ä¾‹å­—å…¸çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªé˜¶æ®µ<code>add.__dict__</code>ç­‰äº<code>&#123;&#39;__stamped__&#39;: True&#125;</code></li>
<li><code>stamp(func)</code>è¿”å›äº†ä¿®æ”¹è¿‡çš„<code>func</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åˆä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ ç»™<code>timer</code>è£…é¥°å™¨</li>
<li><code>timer</code>è£…é¥°å™¨å†…çš„<code>wrapper</code>å‡½æ•°ç”±äºä½¿ç”¨äº†<code>functools.wraps</code>è£…é¥°å™¨ï¼Œæ‰€ä»¥å®ƒå¤åˆ¶äº†å‰é¢æåˆ°çš„å…ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶å®ä¾‹å­—å…¸ä¸­åŒæ­¥äº†<code>__stamp__</code>å±æ€§ã€‚è¿™ä¸ª<code>wrapper</code>å‡½æ•°è¢«è¿”å›å¹¶èµ‹å€¼ç»™<code>add</code>å˜é‡</li>
<li>è°ƒç”¨<code>add(1, 2)</code>ï¼Œå¼€å§‹è®¡æ—¶å¹¶è¿è¡Œ<code>stamp(add)</code>ä¼ å›æ¥çš„å‡½æ•°ï¼Œè¿™ä¸ªè¿è¡Œå›æ¥çš„å‡½æ•°ä¼šå»å…ˆ<code>LOAD_GLOBAL</code>æ‰¾åˆ°è¿™ä¸ª<code>add</code>å‡½æ•°ï¼Œç”±äºåœ¨å…¨å±€å‘½åç©ºé—´å†…<code>add</code>å·²ç»è¢«é‡æ–°èµ‹å€¼ä¸º<code>wrapper</code>å‡½æ•°ï¼Œæ‰€ä»¥ä¼šä»è¿™ä¸ª<code>wrapper</code>å‡½æ•°å†…æ‰¾<code>__stamp__</code>è¿™ä¸ªå±æ€§ã€‚</li>
<li>åœ¨å®ä¾‹å­—å…¸å†…æ‰¾åˆ°äº†è¿™ä¸ªå±æ€§ï¼Œæ‰€ä»¥å¯ä»¥æ‰“å°å‡ºæ¥<code>True</code></li>
<li>å®Œæˆè®¡æ—¶æ‰“å°å‡ºæ¥æ—¶é—´</li>
</ol>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯<code>LOAD_GLOBAL</code>å¹¶ä¸æ˜¯è¿™ä¸ªå‡½æ•°å¯ä»¥è¿è¡Œçš„ä¸»è¦åŸå› ã€‚ç”±äºè¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨å…¨å±€ç©ºé—´å†…æ‰€ä»¥ä»–ä¼šä½¿ç”¨å…¨å±€æœç´¢ï¼Œè€Œå¦‚æœåœ¨ç±»ä½“å†…åˆ™ä¼šä½¿ç”¨<code>LOAD_ATTR</code>ã€‚ä½†æ˜¯è¿™äº›éƒ½ä¸å½±å“ï¼Œå› ä¸ºæ— è®ºåœ¨ä»€ä¹ˆå‘½åç©ºé—´æœç´¢<code>add</code>å‡½æ•°ï¼Œéƒ½ä¼šæœç´¢åˆ°è¿™ä¸ª<code>wrapper</code>ï¼Œå› ä¸ºå…¶è¯­æ³•ç³–çš„ç‰¹æ€§ä¼šåœ¨å½“å‰å‘½åç©ºé—´å†…é‡æ–°èµ‹å€¼å¹¶è¦†ç›–æ‰åŸæ¥çš„é‚£ä¸ªå‡½æ•°ã€‚</p>
<h3 id="å¤šä¸ªè£…é¥°å™¨åµŒå¥—"><a href="#å¤šä¸ªè£…é¥°å™¨åµŒå¥—" class="headerlink" title="å¤šä¸ªè£…é¥°å™¨åµŒå¥—"></a>å¤šä¸ªè£…é¥°å™¨åµŒå¥—</h3><p>ä¸Šé¢çš„ä¾‹å­å…¶å®å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œå¤šä¸ªè£…é¥°å™¨åµŒå¥—çš„è§„å¾‹å°±æ˜¯ä»ä¸‹å¾€ä¸Šè¿ç®—ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="built_in">print</span>(f.__name__)</span><br><span class="line">    f.__name__ = f.__name__[:-<span class="number">1</span>] + <span class="built_in">str</span>(<span class="built_in">int</span>(f.__name__[-<span class="number">1</span>]) + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="meta">@dec    </span><span class="comment"># func2</span></span><br><span class="line"><span class="meta">@dec    </span><span class="comment"># func1</span></span><br><span class="line"><span class="meta">@dec    </span><span class="comment"># func0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func0</span>():</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(func0.__name__)    <span class="comment"># func3</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç çš„ä½œç”¨å°±æ˜¯æ‰“å°<code>f</code>çš„åå­—ï¼Œç„¶åæŠŠæœ€åä¸€ä½æ•°å­—åŠ ä¸€å¹¶è¿”å›è¿™ä¸ªå‡½æ•°ã€‚ä¸Šé¢è£…é¥°å™¨çš„è¯­æ³•ç³–ä¸ä¸‹é¢å†™å‡ºæ¥çš„ç‰ˆæœ¬æ— å¼‚ï¼Œé…·ä¼¼elixerçš„<code>|&gt;</code>è¿ç®—ç¬¦ï¼Œå°†ç»“æœä¾æ¬¡ä¼ é€åˆ°å‡½æ•°å†…åŠ å·¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func0</span>():</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">func0 = dec(func0)    <span class="comment"># func0</span></span><br><span class="line">func0 = dec(func0)    <span class="comment"># func1</span></span><br><span class="line">func0 = dec(func0)    <span class="comment"># func2</span></span><br><span class="line"><span class="built_in">print</span>(func0.__name__)    <span class="comment"># func3</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œä¸ºäº†è¿½æ±‚ä¸¥è°¨æ€§ä¸€å®šæ˜¯åˆ†å¼€å†™çš„ï¼Œå› ä¸ºæ¯è£…é¥°ä¸€æ¬¡éƒ½ä¼šèµ‹å€¼ç»™<code>func0</code>ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ä¸‹é¢è¿™ç§one liner:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func0</span>(): ...</span><br><span class="line">func0 = dec(dec(dec(func0)))</span><br></pre></td></tr></table></figure>

<h3 id="è£…é¥°å™¨ä¼ å‚"><a href="#è£…é¥°å™¨ä¼ å‚" class="headerlink" title="è£…é¥°å™¨ä¼ å‚"></a>è£…é¥°å™¨ä¼ å‚</h3><p>è¿˜æ˜¯ä»¥æˆ‘ä»¬çš„<code>timer</code>è£…é¥°å™¨ä¸¾ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ§åˆ¶ä¼ è¿›å»çš„å‚æ•°çš„è¿è¡Œæ¬¡æ•°å¹¶è®°å½•æ—¶é—´ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åƒ<code>functools.wraps</code>è£…é¥°å™¨ä¸€æ ·è¦æ±‚ä¼ è¿›æ¥ä¸€ä¸ªå‚æ•°ï¼Œè€Œ<code>timer</code>å› ä¸ºè¦æ¥å—è¿™ä¸ªå‚æ•°æ‰€ä»¥å¿…é¡»åœ¨æœ€å¤–å±‚å†åµŒå¥—ä¸€ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">timer</span>(<span class="params">*, epochs</span>):</span><br><span class="line">    <span class="keyword">assert</span> epochs &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">actual_decorator</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">        @functools.wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            t1 = time.perf_counter()</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">                ret = func(*args, **kwargs)</span><br><span class="line">            t2 = time.perf_counter()</span><br><span class="line">            <span class="built_in">print</span>(t2 - t1)</span><br><span class="line">            <span class="keyword">return</span> ret  <span class="comment"># ç¡®ä¿å°†è¿”å›å€¼å†è¿”å›å›å»</span></span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> actual_decorator</span><br></pre></td></tr></table></figure>
<p>è¦ä½¿ç”¨èµ·æ¥ï¼Œå°±å¿…é¡»å¾—åœ¨<code>@timer</code>æ—¶ä¼ ä¸€ä¸ªå‚æ•°ä»£è¡¨è¿è¡Œå¤šå°‘æ¬¡è¿™ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@timer(<span class="params">epochs=<span class="number">1_0000_0000</span></span>)    </span><span class="comment"># 8.325460200001544 PythonçœŸçš„æ…¢</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>, <span class="number">2</span>))    <span class="comment"># 3</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°çš„è§£æï¼š</p>
<ol>
<li>æ— è®ºå®ƒä¼ å‚ä¹Ÿå¥½ä¸ä¼ å‚ä¹Ÿå¥½ï¼Œç°æ ¹æ®è£…é¥°å™¨çš„è¯­æ³•ç³–å®šä¹‰æ”¹å†™æˆæ­£å¸¸çš„å½¢å¼<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">add = timer(epoches=<span class="number">1_0000_0000</span>)(add)</span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li>è€Œæœ€é‡è¦çš„ä¸€è¡Œå°±æ˜¯<code>timer(epochs=1_0000_0000)(add)</code>ï¼Œæ ¹æ®è¿ç®—æ³•åˆ™ï¼Œå…ˆè®¡ç®—<code>timer(epochs=1_0000_0000)</code>ã€‚è€Œè¿™ä¸ªå‡½æ•°ç›´æ¥è¿”å›äº†<code>actual_decorator</code></li>
<li>æ‰€ä»¥åŸä»£ç å¯ä»¥è¢«â€œç®€å†™â€æˆ<code>actual_decorator(add)</code>ï¼Œè€Œè¿™ä¸ªå½¢å¼å’Œåªä½¿ç”¨<code>@actual_decorator</code>æ— å¼‚ï¼Œåªæ˜¯<code>epochs</code>è¢«é—­åŒ…ä¿å­˜äº†è€Œå·²</li>
<li>å°†<code>actual_decorator</code>çš„è¿”å›å€¼<code>wrapper</code>èµ‹å€¼ç»™<code>add</code>ï¼Œç°åœ¨<code>add</code>å¯ä»¥é€šè¿‡é—­åŒ…æ‰¾åˆ°å±äº<code>timer</code>çš„<code>epochs</code>å’Œå±äº<code>actual_decorator</code>çš„<code>func</code></li>
<li>è°ƒç”¨<code>add(1, 2)</code>ï¼Œæ‰“å°å‡ºæ¥è¿è¡Œæ—¶é—´å’Œç»“æœ3</li>
</ol>
<h3 id="ç±»ä¹Ÿå¯ä»¥è¢«è£…é¥°"><a href="#ç±»ä¹Ÿå¯ä»¥è¢«è£…é¥°" class="headerlink" title="ç±»ä¹Ÿå¯ä»¥è¢«è£…é¥°"></a>ç±»ä¹Ÿå¯ä»¥è¢«è£…é¥°</h3><p>æ³¨æ„è¿™é‡Œçš„ç±»æ˜¯è¢«è£…é¥°çš„ï¼Œè€Œä¸æ˜¯è£…é¥°å™¨æœ¬èº«ã€‚ç±»è¢«è£…é¥°ä¸å‡½æ•°çš„å”¯ä¸€ä¸åŒæ˜¯ä¼ è¿›è£…é¥°å™¨çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¿™ä¸ªç±»æœ¬èº«è€Œä¸æ˜¯å‡½æ•°ç½¢äº†ï¼Œè¯­æ³•ç³–æ˜¯ä¸€æ ·çš„ã€‚ä¸‹é¢çš„ä¾‹å­æ ¹æ®<code>__gt__</code>åŠ¨æ€ç”Ÿäº§èƒ½äº†<code>__lt__</code>ç­‰å¤§å°æ¯”è¾ƒæ–¹æ³•:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_lt</span>(<span class="params">cls</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">hasattr</span>(cls, <span class="string">&quot;__gt__&quot;</span>):</span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line">    cls.__lt__ = <span class="keyword">lambda</span> self, other: <span class="keyword">not</span> self &gt; other</span><br><span class="line">    <span class="keyword">return</span> cls</span><br><span class="line"></span><br><span class="line"><span class="meta">@generate_lt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyInt</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value</span>):</span><br><span class="line">        self.value = value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__gt__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.value &gt; other</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(MyInt(<span class="number">5</span>) &lt; <span class="number">3</span>)    <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(MyInt.__lt__)    <span class="comment"># &lt;function generate_lt.&lt;locals&gt;.&lt;lambda&gt; at 0x0000023D6988EB90&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™ç®—æ˜¯ä¸€ä¸ªç®€ä¾¿ç‰ˆçš„<code>functools.total_ordering</code>ï¼Œå…¶å¯ä»¥é€šè¿‡ä¸€ä¸ªæ¯”è¾ƒå¤§å°æ–¹æ³•å’Œä¸€ä¸ªç­‰äºæ–¹æ³•ç”Ÿæˆæ‰€æœ‰çš„å¤§å°æ¯”è¾ƒæ–¹æ³•ã€‚<br>åœ¨è¿™ä¸ªè£…é¥°å™¨å†…è¿˜å¯ä»¥ç”Ÿæˆä¸€ä¸ªç±»ç„¶åè¿”å›ï¼Œæ›¿æ¢æ‰ç”¨æˆ·çš„ç±»ï¼Œæ¯”å¦‚<code>dataclass</code>å°±æ˜¯è¿™ä¹ˆåšçš„ï¼Œè¿™é‡Œæœ‰è¶…çº§ç®€åŒ–è¿‡çš„ç‰ˆæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> Function</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_setter</span>(<span class="params">name, type_guard</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">isinstance</span>(other, type_guard)</span><br><span class="line">        <span class="built_in">setattr</span>(self, <span class="string">f&quot;__<span class="subst">&#123;name&#125;</span>&quot;</span>, other)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_getter</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> self: <span class="built_in">getattr</span>(self, <span class="string">f&quot;__<span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simple_dataclass</span>(<span class="params">cls</span>):</span><br><span class="line">    namespace = &#123;&#125;</span><br><span class="line">    init = <span class="string">f&quot;def __init__(self, <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(x <span class="keyword">for</span> x <span class="keyword">in</span> cls.__annotations__)&#125;</span>):\n&quot;</span></span><br><span class="line">    <span class="keyword">for</span> name, type_ <span class="keyword">in</span> cls.__annotations__.items():</span><br><span class="line">        namespace[<span class="string">f&quot;get_<span class="subst">&#123;name&#125;</span>&quot;</span>] = generate_getter(name)    </span><br><span class="line">        <span class="comment"># è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨lambdaï¼Œæ¯”å¦‚è¿™æ ·ï¼š</span></span><br><span class="line">        <span class="comment"># namespace[f&quot;get_&#123;name&#125;&quot;] = lambda self: getattr(self, f&quot;__&#123;name&#125;&quot;)</span></span><br><span class="line">        <span class="comment"># é—­åŒ…æœç´¢çš„æ—¶å€™(LOAD_DEREF)ä¼šæ‰¾åˆ°å¾ªç¯æœ€åä¸€ä¸ªnameï¼Œè€Œä¸æ˜¯ç°åœ¨å®šä¹‰çš„è¿™ä¸ª</span></span><br><span class="line">        <span class="comment"># æ¢è¨€ä¹‹æ‰€æœ‰çš„ getter éƒ½ä¼šè·å–åˆ°æœ€åä¸€æ¬¡å¾ªç¯çš„name</span></span><br><span class="line">        namespace[<span class="string">f&quot;set_<span class="subst">&#123;name&#125;</span>&quot;</span>] = generate_setter(name, type_)</span><br><span class="line">        init += <span class="string">f&quot;    self.set_<span class="subst">&#123;name&#125;</span>(<span class="subst">&#123;name&#125;</span>)\n&quot;</span></span><br><span class="line">    code = <span class="built_in">compile</span>(init, cls.__module__, <span class="string">&quot;exec&quot;</span>)</span><br><span class="line">    namespace[<span class="string">&quot;__init__&quot;</span>] = FunctionType(</span><br><span class="line">        code.co_consts[<span class="number">0</span>], <span class="built_in">globals</span>(), <span class="string">&quot;__init__&quot;</span>  <span class="comment"># è¿™ä¸ªæ‰æ˜¯å‡½æ•°çš„code objectï¼Œcodeæœ¬èº«æ˜¯åˆ©ç”¨è¿™ä¸ªæ­å»ºå‡½æ•°</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">type</span>(cls.__qualname__, cls.__bases__, namespace)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨äº†ä¸€äº›é»‘é­”æ³•:</p>
<ul>
<li>å¯¹<code>type</code>ä¸‰å‚æ•°åˆ›å»ºç±»ä¸äº†è§£çš„åŒå­¦å¯ä»¥çœ‹è¿™é‡Œï¼š<a href="/2022/11/18/Python-Metaclass%E4%B8%8E%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/">Pythonå…ƒç±»+ä½¿ç”¨æ¡ˆä¾‹</a></li>
<li>è¿™é‡Œä½¿ç”¨äº† FunctionType ç›´æ¥åˆ›å»ºå‡½æ•°å®ä¾‹è€Œéä½¿ç”¨<code>def</code>å…³é”®å­—ï¼Œå¦‚æœä¸äº†è§£çš„è¯å¯ä»¥çœ‹è¿™é‡Œï¼š<a href=""><code>def</code>å…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸPython Code Objectè¯¦è§£</a></li>
</ul>
<p>è¦ä½¿ç”¨è¿™ä¸ªç®€å•æ•°æ®ç±»ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æŠŠå†™å¥½ç±»å‹çš„ç±»æŒ‚ä¸Šè£…é¥°å™¨ï¼Œå°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆ<code>setter</code>ï¼Œ<code>getter</code>ï¼Œè¿˜æœ‰<code>__init__</code>æ–¹æ³•å•¦ï¼ˆè™½ç„¶è¿™ç§<code>getter</code> &#x2F; <code>setter</code>åº”è¯¥ç”¨<code>property</code>æ›´å¥½ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@simple_dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    hi: <span class="built_in">str</span></span><br><span class="line">    n: <span class="built_in">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A()    # TypeError: __init__() missing 2 required positional arguments: &#x27;hi&#x27; and &#x27;n&#x27;</span></span><br><span class="line"><span class="comment"># A(1, &quot;234&quot;)    # AssertionError</span></span><br><span class="line"><span class="comment"># print(A(&quot;234&quot;, 2).hi)    # AttributeError: &#x27;A&#x27; object has no attribute &#x27;hi&#x27;</span></span><br><span class="line">a = A(<span class="string">&quot;234&quot;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(a.__hi)    <span class="comment"># 234 æ³¨ï¼šè¿è¡Œæ—¶åŠ¨æ€è®¾ç½®çš„å±æ€§ä¸ä¼šå˜æˆ _A__hi</span></span><br><span class="line"><span class="built_in">print</span>(a.get_hi())    <span class="comment"># 234</span></span><br><span class="line">a.set_hi(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.get_hi())    <span class="comment"># hello</span></span><br></pre></td></tr></table></figure>

<h3 id="ç±»ä¹Ÿå¯ä»¥è¢«å½“ä½œè£…é¥°å™¨"><a href="#ç±»ä¹Ÿå¯ä»¥è¢«å½“ä½œè£…é¥°å™¨" class="headerlink" title="ç±»ä¹Ÿå¯ä»¥è¢«å½“ä½œè£…é¥°å™¨"></a>ç±»ä¹Ÿå¯ä»¥è¢«å½“ä½œè£…é¥°å™¨</h3><p>æ ¹æ®è¯­æ³•ç³–çš„ç‰¹æ€§ï¼Œè¢«è£…é¥°çš„ä¸œè¥¿åªæ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è¢«ä¼ è¿›<code>__call__</code>äº†è€Œå·²ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªç±»è£…é¥°å°±ç›¸å½“äºä»¥è¢«è£…é¥°çš„ç»“æ„ä½“ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°å®ä¾‹åŒ–è¿™ä¸ªç±»ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç å¯èƒ½çœ‹èµ·æ¥å¾ˆç¦»è°±ï¼Œä½†æ˜¯æ‹†è§£å¼€æ¥å°±å¾ˆæ­£å¸¸äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@str</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hi</span>():</span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(hi, <span class="built_in">type</span>(hi))    <span class="comment"># &lt;function hi at %p&gt; &lt;class &#x27;str&#x27;&gt;</span></span><br></pre></td></tr></table></figure>
<p>æŠŠè¿™ä¸ªè¯­æ³•ç³–å¤åŸæˆå®ƒåŸæ¥çš„æ ·å­ï¼Œå°±ä¸€ç›®äº†ç„¶äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hi</span>(): ...</span><br><span class="line">hi = <span class="built_in">str</span>(hi)</span><br><span class="line"><span class="built_in">print</span>(hi, <span class="built_in">type</span>(hi))</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥è¯´ä¸Šé¢çš„è£…é¥°å™¨å®é™…ä¸Šåšçš„å°±æ˜¯æŠŠ<code>hi</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ è¿›<code>str</code>çš„æ„é€ å™¨ç„¶åå†èµ‹å€¼ä¼š<code>hi</code>è€Œå·²ã€‚<br>é‚£ä¹ˆè¿™ä¸ªæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ<code>functools.wraps</code>å®é™…ä¸Šå°±æ˜¯ä½¿ç”¨äº†è¿™ç§é»‘é­”æ³•å®ç°çš„ã€‚</p>
<h2 id="è£…é¥°å™¨ä½¿ç”¨é‰´èµ"><a href="#è£…é¥°å™¨ä½¿ç”¨é‰´èµ" class="headerlink" title="è£…é¥°å™¨ä½¿ç”¨é‰´èµ"></a>è£…é¥°å™¨ä½¿ç”¨é‰´èµ</h2><h3 id="è£…é¥°å™¨è£…é¥°è£…é¥°å™¨ä¹‹functools-wraps"><a href="#è£…é¥°å™¨è£…é¥°è£…é¥°å™¨ä¹‹functools-wraps" class="headerlink" title="è£…é¥°å™¨è£…é¥°è£…é¥°å™¨ä¹‹functools.wraps"></a>è£…é¥°å™¨è£…é¥°è£…é¥°å™¨ä¹‹<code>functools.wraps</code></h3><p>è¿™ä¸ªè£…é¥°å™¨å¾ˆæœ‰æ„æ€ï¼Œå®ƒæ—¢åŒ…æ‹¬äº†è£…é¥°å™¨ä¼ å‚ï¼Œä¹ŸåŒ…æ‹¬äº†ç±»è£…é¥°å™¨ã€‚å…¶ä½œç”¨å°±æ˜¯åœ¨<code>wrapper</code>å‡½æ•°åŒ…è£…<code>func</code>å‡½æ•°çš„æ—¶å€™å°†<code>func</code>çš„<code>assigned</code>é‡Œæ‰€æœ‰çš„å±æ€§éå†èµ‹å€¼ç»™<code>wrapper</code>(åŒ…æ‹¬ <code>__module__</code>, <code>__annotation__</code>ç­‰)ï¼Œå¹¶éå†<code>updated</code>é‡Œçš„å±æ€§åç§°ï¼Œä»¥<code>func</code>çš„è¯¥å±æ€§æ›´æ–°<code>wrapper</code>çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´<code>updated</code>é‡Œçš„å±æ€§å¿…é¡»æ”¯æŒ<code>update</code>æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ç¨ä½œä¿®æ”¹è¿‡çš„æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_wrapper</span>(<span class="params">wrapper, wrapped, assigned, updated</span>):</span><br><span class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> assigned:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            value = <span class="built_in">getattr</span>(wrapped, attr)</span><br><span class="line">        <span class="keyword">except</span> AttributeError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">setattr</span>(wrapper, attr, value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> updated:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            value = <span class="built_in">getattr</span>(wrapped, attr)</span><br><span class="line">        <span class="keyword">except</span> AttributeError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">getattr</span>(wrapper, attr).update(value)</span><br><span class="line"></span><br><span class="line">    wrapper.__wrapped__ = wrapped    <span class="comment"># å¯ä»¥è®¿é—®åˆ°åŸå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_wraps</span>(<span class="params"></span></span><br><span class="line"><span class="params">    func,</span></span><br><span class="line"><span class="params">    assigned=(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="params">        <span class="string">&quot;__module__&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="params">        <span class="string">&quot;__name__&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="params">        <span class="string">&quot;__qualname__&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="params">        <span class="string">&quot;__doc__&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="params">        <span class="string">&quot;__annotations__&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="params">    </span>),  <span class="comment"># å¤åˆ¶è¿™äº›å±æ€§åˆ° func ä¸Š</span></span></span><br><span class="line"><span class="params">    updated=(<span class="params"><span class="string">&quot;__dict__&quot;</span>,</span>),  <span class="comment"># æ›´æ–° func çš„è¿™äº›å±æ€§åˆ°ä¸‹é¢è£…é¥°çš„å‡½æ•°ä¸Š</span></span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">return</span> functools.partial(update_wrapper, wrapped=func, assigned=assigned, updated=updated)</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯è€è§„çŸ©ï¼Œæˆ‘ä»¬å€Ÿç€ä¸€ä¸ªè£…é¥°å™¨çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_decorator</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @my_wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹è¿è¡Œå‡½æ•°<span class="subst">&#123;func.__qualname__&#125;</span>ï¼&quot;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç»“æŸè¿è¡Œå‡½æ•°<span class="subst">&#123;func.__qualname__&#125;</span>ï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="meta">@my_decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a</span>(<span class="params">x: <span class="built_in">int</span> = <span class="number">1</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;this is a doc&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>æŒ‰ç…§ç¨‹åºè¿è¡Œé¡ºåºï¼Œå…ˆæ˜¯<code>@my_decorator</code>è£…é¥°<code>a</code>ï¼Œç®€åŒ–è¯­æ³•ç³–ï¼Œå°†ç¨‹åºå˜æˆè¿™æ ·ï¼š<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">a</span>(<span class="params">x: <span class="built_in">int</span> = <span class="number">1</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;this is a doc&quot;&quot;&quot;</span></span><br><span class="line">a = my_decorator(a)</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li>åœ¨<code>my_decorator</code>å†…éƒ¨çš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è£…é¥°è¿™ä¸ª<code>inner</code>å‡½æ•°ï¼Œä¸€æ ·çš„ç®€åŒ–è¯­æ³•ç³–<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_decorator</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹è¿è¡Œå‡½æ•°<span class="subst">&#123;func.__qualname__&#125;</span>ï¼&quot;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç»“æŸè¿è¡Œå‡½æ•°<span class="subst">&#123;func.__qualname__&#125;</span>ï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    inner = my_wraps(func)(inner)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li>æ ¹æ®è¿ç®—ä¼˜å…ˆçº§ï¼Œåœ¨åˆ›å»ºå®Œ<code>inner</code>å‡½æ•°ä¹‹ååº”è¯¥å…ˆè¿è¡Œ<code>my_wraps(func)</code>ï¼Œå°†ä»–è¿”å›çš„ä¸€å¤§ä¸²éƒ½æ›¿æ¢è¿›æ¥ï¼š<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_decorator</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹è¿è¡Œå‡½æ•°<span class="subst">&#123;func.__qualname__&#125;</span>ï¼&quot;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç»“æŸè¿è¡Œå‡½æ•°<span class="subst">&#123;func.__qualname__&#125;</span>ï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="comment"># è¿™é‡Œ functools.partial æ˜¯ä¸€ä¸ªç±»ï¼ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼æ‰€ä»¥æ˜¯ä¸€ä¸ª functools_object.__call__(inner)</span></span><br><span class="line">    inner = functools.partial(update_wrapper, wrapped=func, assigned=assigned, updated=updated)(inner)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br></pre></td></tr></table></figure>
<p><code>functools.partial</code>æ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿå®ƒå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»åœ¨åˆå§‹åŒ–çš„æ—¶å€™ç¬¬ä¸€ä¸ªå‚æ•°ä¸€å®šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œåé¢å¯ä»¥ç»™ä»»æ„é‡çš„æ™®é€šå‚æ•°å’Œå…³é”®å­—å‚æ•°ã€‚å®ä¾‹åŒ–ä¹‹åï¼Œå¦‚æœ<code>__call__</code>æ–¹æ³•è¢«è°ƒç”¨ï¼Œå°±ä¼šè°ƒç”¨ä¼ è¿›å»çš„å‡½æ•°ï¼Œå¹¶å°†å‚æ•°åˆ—è¡¨è¡¥ä¸Šã€‚å‚æ•°åˆ—è¡¨ä¼šå…ˆä½¿ç”¨å®ä¾‹åŒ–ä¼ è¿›å»çš„ä½ç½®å‚æ•°ï¼Œç„¶åä½¿ç”¨è°ƒç”¨æ—¶çš„ä½ç½®å‚æ•°ï¼Œæœ€åå†åŠ ä¸Šæ‰€æœ‰çš„å…³é”®å­—å‚æ•°ï¼Œæ¯”å¦‚ï¼š</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">*args, hi=<span class="string">&quot;hi&quot;</span>, **kwargs</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;hi=&#125;</span>, <span class="subst">&#123;args=&#125;</span>, <span class="subst">&#123;kwargs=&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">partial = functools.partial(foo, <span class="string">&quot;åˆ›å»ºæ—¶ä¼ çš„ä½ç½®å‚æ•°&quot;</span>, hi=<span class="string">&quot;hello&quot;</span>, åˆ›å»ºæ—¶ä¼ çš„å…³é”®å­—å‚æ•°=<span class="number">123</span>)</span><br><span class="line">partial(<span class="string">&quot;è°ƒç”¨æ—¶ä¼ çš„ä½ç½®å‚æ•°&quot;</span>)    <span class="comment"># hi=&#x27;hello&#x27;, args=(&#x27;åˆ›å»ºæ—¶ä¼ çš„ä½ç½®å‚æ•°&#x27;, &#x27;è°ƒç”¨æ—¶ä¼ çš„ä½ç½®å‚æ•°&#x27;), kwargs=&#123;&#x27;åˆ›å»ºæ—¶ä¼ çš„å…³é”®å­—å‚æ•°&#x27;: 123&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œ<code>partial</code>æä¾›äº†<strong>éƒ¨åˆ†</strong>å‚æ•°ï¼Œè€Œå†è°ƒç”¨(<code>__call__</code>)çš„æ—¶å€™åˆ™ä¼šå°†å‚æ•°åˆ—è¡¨æŒ‰ç…§åˆšæ‰è¯´è¿‡çš„é¡ºåºè¡¥é½</p>
</blockquote>
</blockquote>
</li>
<li>åˆ›å»ºå¥½äº†<code>partial</code>å¯¹è±¡ä¹‹åï¼Œè°ƒç”¨å¹¶ä¼ è¿›å»<code>inner</code>å‡½æ•°ï¼Œæ ¹æ®<code>partial</code>çš„è¿è¡Œè§„åˆ™ï¼Œæ‰€æœ‰é‚£ä¸€å¤§è¡Œéƒ½ç›¸å½“äº<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update_wrapper(inner, wrapped=func, assigned=assigned, updated=updated)</span><br></pre></td></tr></table></figure>
é‚£ä¹ˆåªéœ€è¦è¿è¡Œ<code>update_wrapper</code>ï¼Œå°†ç»“æœèµ‹å€¼ç»™<code>inner</code>ç„¶åè¿”å›<code>inner</code>å°±å¥½äº†</li>
<li>åœ¨<code>update_wrapper</code>å†…æ‰€åšçš„å°±æ˜¯éå†<code>assigned</code>é‡Œçš„å±æ€§åç§°ï¼Œå°†åŸæ¥å‡½æ•°çš„å¯¹åº”å±æ€§èµ‹å€¼ç»™ä¼ è¿›å»çš„<code>inner</code>ï¼Œä¹Ÿå°±æ˜¯æ›¿æ¢æ‰<code>__annotations__</code>ä¹‹ç±»çš„å…ƒä¿¡æ¯ï¼›ç„¶åéå†<code>updated</code>é‡Œçš„å±æ€§åç§°ï¼Œä½¿ç”¨åŸæ¥å‡½æ•°çš„å¯¹åº”å±æ€§æ›´æ–°ä¼ è¿›å»çš„<code>inner</code>ï¼Œè¿™ä¹Ÿå°±è¦æ±‚äº†è¿™ä¸ªå±æ€§å¿…é¡»æ”¯æŒ<code>update</code>æ–¹æ³•ï¼Œè€Œä¸ä¼ ä»»ä½•å…¶ä»–å‚æ•°çš„æƒ…å†µä¸‹æ›´æ–°çš„åªæœ‰å®ä¾‹å­—å…¸(<code>__dict__</code>)å±æ€§ï¼›æœ€åå†èµ‹å€¼<code>__wrapper__</code>å±æ€§ï¼Œå¼•ç”¨ä¸€ä¸‹è¢«åŒ…è£…çš„å‡½æ•°</li>
<li><code>my_wraps</code>è£…é¥°å™¨ç»“æŸï¼Œè¿”å›ä¿®æ”¹è¿‡çš„<code>wrapper</code>å‡½æ•°</li>
</ol>
<p>æ³¨æ„åˆ°<code>my_wraps</code>å…¶å®è¿˜å¯ä»¥æŒ‡å®š<code>assigned</code>å’Œ<code>updated</code>å‚æ•°ï¼Œæ‰€ä»¥è®©<code>my_wraps</code>è£…é¥°å™¨ä¸å»èµ‹å€¼<code>__doc__</code>å±æ€§ä¹Ÿæ˜¯å®Œå…¨å¯ä»¥çš„ï¼Œåªéœ€è¦ä¼ ä¸€ä¸ªé™¤äº†è¯¥å‚æ•°åçš„å…ƒç»„å°±å¯ä»¥äº†ã€‚</p>
<h3 id="ç©ºé—´æ¢æ—¶é—´ï¼Œlru-cahce"><a href="#ç©ºé—´æ¢æ—¶é—´ï¼Œlru-cahce" class="headerlink" title="ç©ºé—´æ¢æ—¶é—´ï¼Œlru_cahce!"></a>ç©ºé—´æ¢æ—¶é—´ï¼Œ<code>lru_cahce</code>!</h3><p>ä¸ºäº†ç®€ä¾¿åŸå› å’Œè®²è§£è£…é¥°å™¨çš„ä¸»æ—¨ï¼Œæˆ‘ä¼šè®²è§£<code>lru_cahce</code>çš„ç®€ä¾¿ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰lruçš„<code>cache</code>è£…é¥°å™¨å¹¶ç»è¿‡ä¿®æ”¹ã€‚è¿™ä¸ªè£…é¥°å™¨æ‰€åšçš„å°±æ˜¯å°†ä¼ è¿›æ¥çš„å‚æ•°å’Œç»“æœå­˜åˆ°ä¸€ä¸ªå­—å…¸å†…ï¼Œå¦‚æœæœ‰åŒæ ·çš„å‚æ•°è¢«ä¼ åˆ°å‡½æ•°å†…ï¼Œå°±ä¸ä¼šè¿è¡Œå‡½æ•°ä½“è€Œæ˜¯ç›´æ¥è¿”å›ç»“æœã€‚è¿™å¯ä»¥å¤§å¤§å¢åŠ éœ€è¦é‡å¤è®¡ç®—æˆ–è€…é€’å½’å‡½æ•°çš„è¿è¡Œé€Ÿåº¦ï¼Œè™½ç„¶åœ¨ç©ºé—´ä¸Šæ¶ˆè€—ä¸å°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">@functools.cache</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cached_fib</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">assert</span> n &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> cached_fib(n - <span class="number">1</span>) + cached_fib(n - <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">assert</span> n &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> fib(n - <span class="number">1</span>) + fib(n - <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">t1 = time.perf_counter()</span><br><span class="line">cached_fib(<span class="number">400</span>)</span><br><span class="line">t2 = time.perf_counter()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cached_fib: <span class="subst">&#123;t2 - t1&#125;</span>&quot;</span>)    <span class="comment"># 0.0004117000003134308</span></span><br><span class="line"></span><br><span class="line">t1 = time.perf_counter()</span><br><span class="line">fib(<span class="number">37</span>)</span><br><span class="line">t2 = time.perf_counter()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;fib: <span class="subst">&#123;t2 - t1&#125;</span>&quot;</span>)    <span class="comment"># 3.925901200000226 100æˆ‘è·‘äº†äº”åˆ†é’Ÿä¹Ÿæ²¡è·‘å‡ºæ¥</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°æœ‰äº†<code>cache</code>è£…é¥°å™¨ä¹‹åé€Ÿåº¦ç”šè‡³å¯ä»¥åšåˆ°æ¯«ç§’çº§ï¼Œè¿™é‡Œç”¨400æ˜¯å› ä¸ºåœ¨å¤§å°±ä¼šçˆ†æ ˆäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä¼šç”¨ç®€åŒ–è¿‡çš„ä»£ç æ¥å±•ç¤º<code>cache</code>çš„å¤§è‡´å·¥ä½œæµç¨‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">_HashedSeq</span>(<span class="title class_ inherited__">list</span>):</span><br><span class="line">    __slots__ = <span class="string">&quot;hashvalue&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, tup</span>):</span><br><span class="line">        self[:] = tup</span><br><span class="line">        self.hashvalue = <span class="built_in">hash</span>(tup)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.hashvalue</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CacheWrapper</span>:</span><br><span class="line">    sentinel = <span class="built_in">object</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, f</span>):</span><br><span class="line">        self.f = f</span><br><span class="line">        self.cache = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        key = self.make_key(args, kwargs)</span><br><span class="line">        result = self.cache.get(key, self.sentinel)</span><br><span class="line">        <span class="keyword">if</span> result <span class="keyword">is</span> <span class="keyword">not</span> self.sentinel:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        result = self.f(*args, **kwargs)</span><br><span class="line">        self.cache[key] = result</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">make_key</span>(<span class="params">args, kwds, kwd_mark=(<span class="params"><span class="built_in">object</span>(<span class="params"></span>),</span>), fasttypes=&#123;<span class="built_in">int</span>, <span class="built_in">str</span>&#125;</span>):</span><br><span class="line">        key = args</span><br><span class="line">        <span class="keyword">if</span> kwds:</span><br><span class="line">            key += kwd_mark  <span class="comment"># æŠŠä½ç½®å‚æ•°å’Œå…³é”®å­—å‚æ•°åŒºåˆ†å¼€ï¼Œå› ä¸ºæœ‰å¯èƒ½ä½ç½®å‚æ•°ä¼  dict_item</span></span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> kwds.items():</span><br><span class="line">                key += item</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(key) == <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">type</span>(key[<span class="number">0</span>]) <span class="keyword">in</span> fasttypes:</span><br><span class="line">            <span class="comment"># å¦‚æœåªæœ‰ä¸€ä¸ª str æˆ–è€… int å°±è¿”å›è¿™ä¸ªå¯¹è±¡</span></span><br><span class="line">            <span class="keyword">return</span> key[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> _HashedSeq(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cache</span>(<span class="params">f</span>):</span><br><span class="line">    wrapper = CacheWrapper(f)</span><br><span class="line">    <span class="keyword">return</span> functools.update_wrapper(wrapper, f)</span><br><span class="line">    </span><br><span class="line"><span class="meta">@cache</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cached_fib</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">assert</span> n &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> cached_fib(n - <span class="number">1</span>) + cached_fib(n - <span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(cached_fib(<span class="number">4</span>))    <span class="comment"># 3</span></span><br></pre></td></tr></table></figure>
<p>è€æ ·å­ï¼Œä¸€æ­¥ä¸€æ­¥çœ‹è¿™ä¸ª<code>cache</code>è£…é¥°å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼š</p>
<ol>
<li>åŒ–ç®€è£…é¥°å™¨ï¼Œ<code>cached_fib = functools.update_wrapper(CacheWrapper(f), f)</code></li>
<li>å¤–é¢é‚£ä¸€åœˆ<code>update_wrapper</code>å°±æ˜¯ä¸Šé¢<code>functools.wraps</code>é‡Œé¢çš„ï¼Œåªæ˜¯æŠŠä¸€äº›å…ƒä¿¡æ¯èµ‹å€¼ç»™<code>f</code>è€Œå·²ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥æ‰ï¼Œå¯¹å‡½æ•°çš„è¿è¡Œæ²¡æœ‰ä»»ä½•å½±å“ï¼Œä¹Ÿå°±æ˜¯è¯´<code>CacheWrapper(f)</code>æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>cached_fib</code>ç°åœ¨æ˜¯ä¸€ä¸ª<code>CacheWrapper</code>çš„å¯¹è±¡</li>
<li>è¿è¡Œ<code>cached_fib(3)</code>ï¼Œè¿›å…¥<code>CacheWrapper.__call__</code>ï¼Œåœ¨é‡Œé¢å…ˆé€šè¿‡ä¼ è¿›å»çš„<code>args</code>å’Œ<code>kwargs</code>ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ä¸”ç±»å‹ä¸º<code>str</code>æˆ–è€…<code>int</code>åˆ™åŸå°ä¸åŠ¨è¿”å›ï¼Œå¦åˆ™å°†è·å–åˆ°ä¸€ä¸ª<code>_HashedSeq</code>å¯¹è±¡(<code>make_key</code>)ï¼Œè¿™ä¸ªå¯¹è±¡çš„èŒè´£å°±æ˜¯ä¿å­˜æ•´ç†è¿‡åçš„å‚æ•°åˆ—è¡¨ï¼Œå¹¶åœ¨åˆå§‹åŒ–æ—¶åªè®¡ç®—ä¸€æ¬¡å“ˆå¸Œå€¼ï¼ŒèŠ‚çœç®—åŠ›</li>
<li>åœ¨è·å–åˆ°é”®ä¹‹åè‡ªç„¶ä¾¿æ˜¯åœ¨ç¼“å­˜å­—å…¸é‡Œæ‰¾ä¸€æ‰¾æœ‰æ²¡æœ‰å¯¹åº”çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±ä¼šé»˜è®¤åˆ°<code>sentinel</code>ï¼Œç„¶åè¿è¡Œå‡½æ•°å¹¶å°†é”®å€¼ä¸€å¹¶å­˜åˆ°<code>cache</code>å­—å…¸é‡Œï¼Œå¦åˆ™å°±è¿”å›ç¼“å­˜è¿‡çš„å€¼ã€‚ç”±äºæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œ4ä¸åœ¨ç¼“å­˜ä¸­ï¼Œæ‰€ä»¥å»è¿è¡ŒåŸå‡½æ•°ã€‚</li>
<li>åŸå‡½æ•°è°ƒç”¨äº†<code>cached_fib(3) + cached_fib(2)</code>ï¼Œå€¼å¾—ä¸€æçš„æ˜¯è¿™é‡Œä¼šå…ˆåœ¨å½“å‰å‘½åç©ºé—´ä¸‹å¯»æ‰¾<code>cached_fib</code>ï¼Œæ‰€ä»¥æ‰¾åˆ°çš„è¿™ä¸ªå‡½æ•°å…¶å®ä¹Ÿæ˜¯<code>CacheWrapper</code>çš„å®ä¾‹è€ŒéåŸæ¥çš„å‡½æ•°ã€‚æŒ‰ç…§è¿ç®—æ³•åˆ™å…ˆè¿è¡Œ<code>cached_fib(3)</code>ï¼Œ3ä¸åœ¨ç¼“å­˜ä¸­ï¼Œè¿è¡ŒåŸå‡½æ•°<code>cached_fib(2) + cached_fib(1)</code></li>
<li>ä¸€æ ·çš„å…ˆè¿è¡Œ<code>cached_fib(2)</code>ï¼Œ2ä¹Ÿä¸åœ¨ç¼“å­˜é‡Œï¼Œæ‰€ä»¥è¿è¡Œå‡½æ•°å¾—åˆ°1ï¼Œå¹¶å°†2å’Œ1éƒ½æ”¾å…¥ç¼“å­˜ï¼›å†è¿è¡Œ<code>cached_fib(1)</code>ï¼Œä¸€æ ·åœ¨ç¼“å­˜å†…æ‰¾ä¸åˆ°ï¼Œè¿è¡ŒåŸå‡½æ•°å¾—åˆ°1ï¼Œäºæ˜¯1å’Œ1çš„é”®å€¼å¯¹ä¹Ÿè¢«æ”¾åˆ°ç¼“å­˜é‡Œ</li>
<li><code>cached_fib(3)</code>è¿è¡Œåç»“æœä¸º2ï¼Œæ‰€ä»¥3å’Œ2é”®å€¼å¯¹ä¹Ÿè¢«ä¿å­˜åˆ°ç¼“å­˜ä¸­ã€‚æ¥ä¸‹æ¥è¿è¡Œ<code>cached_fib(2)</code>æ ¹æ®ç¼“å­˜è·å–åˆ°1</li>
<li>æ‰€ä»¥<code>cached_fib(4)</code>çš„ç»“æœæ˜¯3ï¼Œä¹Ÿè¢«ä¿å­˜åˆ°ç¼“å­˜ä¸­å¹¶è¿”å›å€¼ï¼Œæœ€åæ‰“å°å‡ºæ¥3</li>
</ol>
<h3 id="è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨â€¦â€¦"><a href="#è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨â€¦â€¦" class="headerlink" title="è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨â€¦â€¦"></a>è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨â€¦â€¦</h3><p>è¿™æ˜¯ä¸€ä¸ªè¿·æƒ‘è¡Œä¸ºï¼Œçµæ„Ÿæ¥è‡ª<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1je4y127nL">è¿™é‡Œ</a>ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">nest</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> func(func(*args, **kwargs))</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="meta">@nest</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params"><span class="built_in">any</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;----\n<span class="subst">&#123;<span class="built_in">any</span>&#125;</span>\n----&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(say_hi(<span class="string">&quot;hi&quot;</span>))</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">----</span><br><span class="line">----</span><br><span class="line">hi</span><br><span class="line">----</span><br><span class="line">----</span><br></pre></td></tr></table></figure>
<p>æŠŠè¿™ä¸ªè£…é¥°å™¨å±•å¼€ï¼Œå®é™…ä¸Šå°±æ˜¯<code>say_hi(say_hi(&quot;hiâ€œ))</code>ï¼Œè€Œæ¯ä¸€æ¬¡<code>say_hi</code>éƒ½åªæ˜¯æŠŠå­—ç¬¦ä¸²å¤–å±‚å¥—ä¸Šäº†ä¸€å±‚çº¿ï¼Œæ‰€ä»¥ä¸¤æ¬¡è‡ªç„¶ä¸Šä¸‹éƒ½æœ‰ä¸¤æ’çº¿ã€‚æˆ‘ä»¬å¯ä»¥æŠŠäº‹æƒ…æå¾—æ›´å¥½ç©äº›ï¼Œæˆ‘ä»¬è®©<code>nest</code>æ¥è£…é¥°â€è‡ªå·±â€œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">nest</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[0]nest inner <span class="subst">&#123;func.__qualname__&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> func(func(*args, **kwargs))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">id</span>(inner)=&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">id</span>(nest)=&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@nest</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nest</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">id</span>(func)=&#125;</span>, <span class="subst">&#123;func.__qualname__&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[1]nest inner&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> func(func(*args, **kwargs))</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">id</span>(nest)=&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="meta">@nest</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params"><span class="built_in">any</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;----\n<span class="subst">&#123;<span class="built_in">any</span>&#125;</span>\n----&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(say_hi(<span class="string">&quot;hi&quot;</span>))</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">id(nest)=1921889762560</span><br><span class="line">id(inner)=1921889762704</span><br><span class="line">id(nest)=1921889762704</span><br><span class="line"></span><br><span class="line">[0]nest inner nest</span><br><span class="line">id(func)=1921889762560, say_hi</span><br><span class="line">id(func)=1921889762848, nest.&lt;locals&gt;.inner</span><br><span class="line">[1]nest inner</span><br><span class="line">[1]nest inner</span><br><span class="line">[1]nest inner</span><br><span class="line">----</span><br><span class="line">----</span><br><span class="line">----</span><br><span class="line">----</span><br><span class="line">hi</span><br><span class="line">----</span><br><span class="line">----</span><br><span class="line">----</span><br><span class="line">----</span><br></pre></td></tr></table></figure>
<p>æ¥çœ‹çœ‹è¿™ä¸ªç¨‹åºå¹²äº†å•¥ï¼š</p>
<ol>
<li>å®šä¹‰äº†ä¸€ä¸ª<code>nest</code>å‡½æ•°ï¼Œä½¿å¾—è¢«è£…é¥°åçš„å‡½æ•°<code>func</code>è°ƒç”¨<code>func(x)</code>ç­‰åŒäº<code>func(func(x))</code></li>
<li>æ‰“å°å‡º<code>nest</code>å˜é‡æŒ‡å‘çš„å¯¹è±¡çš„id (<code>id(nest)=1921889762560</code>)</li>
<li>åˆå®šä¹‰äº†ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„<code>nest</code>å‡½æ•°ï¼Œä½†æ˜¯è¿™æ¬¡ç”¨åˆšæ‰å®šä¹‰å¥½çš„<code>nest</code>è£…é¥°ï¼Œè¿™é‡ŒæŠŠæœ€ä¸Šé¢çš„<code>nest</code>å‡½æ•°ç§°ä¸º<code>[0]nest</code>è€Œè¢«<code>[0]nest</code>è£…é¥°çš„<code>nest</code>å‡½æ•°ç§°ä¸º<code>[1]nest</code></li>
<li>è¢«è£…é¥°çš„<code>[1]nest</code>ç°åœ¨è™½ç„¶è¿˜å«<code>nest</code>ï¼Œä½†æ˜¯æŒ‡å‘çš„å¯¹è±¡ç»è¿‡è£…é¥°å·²ç»å˜æˆäº†<code>[0]nest.&lt;locals&gt;.inner</code> (<code>[1]nest = [0]nest([1]nest)</code>ï¼Œè€Œ<code>[0]nest</code>è¿”å›çš„æ˜¯å®ƒçš„å±€éƒ¨å˜é‡<code>inner</code>)</li>
<li>æ‰“å°å‡ºç°åœ¨<code>nest</code>å˜é‡æŒ‡å‘çš„è¿™ä¸ªå¯¹è±¡çš„id (<code>id(nest)=1921889762704</code>)ï¼Œå¯ä»¥çœ‹åˆ°ç°åœ¨<code>nest</code>å˜é‡å·²ç»æŒ‡å‘<code>[0]nest.&lt;locals&gt;.inner</code></li>
<li>åœ¨ç©ºè¡Œåçš„è¾“å‡ºéƒ½æ˜¯åœ¨ç¬¬20è¡Œè£…é¥°çš„æ—¶å€™æ‰“å°å‡ºæ¥çš„ã€‚æŠŠè¯­æ³•ç³–è¿˜åŸï¼Œå˜æˆ<code>say_hi = nest(say_hi)</code></li>
<li>è¿™ä¸ª<code>nest</code>æŒ‡å‘çš„æ˜¯<code>[1]nest</code>ï¼Œè€Œè¯¥å‡½æ•°è¢«<code>[0]nest</code>è£…é¥°ï¼Œä¹Ÿå°±æ˜¯è¯´åŸä»£ç å¯ä»¥ç†è§£ä¸º<code>say_hi = [0]nest([1]nest)(say_hi)</code>ï¼ˆè¿˜æ˜¯æŠŠè¯­æ³•ç³–å†™æˆåŸæ¥çš„æ¨¡æ ·ï¼‰</li>
<li>åˆšæ‰å·²ç»çŸ¥é“<code>[0]nest([1]nest)</code>è¿”å›çš„æ˜¯è¿™ä¸ª<code>[0]nest.&lt;locals&gt;.inner</code>å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–æˆ<code>say_hi = [0]nest.&lt;locals&gt;.inner(say_hi)</code></li>
<li>è°ƒç”¨è¿™ä¸ªå±€éƒ¨å‡½æ•°æ‰“å°å‡ºæ¥<code>[0]nest inner nest</code>ï¼Œç„¶åæ ¹æ®ä»£ç è¿”å›<code>func(func(say_hi))</code>ï¼Œè¿™é‡Œ<code>func</code>å°±æ˜¯<code>[1]nest</code>ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸º<code>say_hi = [1]nest([1]nest(say_hi))</code></li>
<li>æ ¹æ®è¿ç®—æ³•åˆ™å…ˆè¿è¡Œ<code>[1]nest(say_hi)</code>ï¼Œæ‰“å°å‡º<code>id(func)=1921889762560, say_hi</code>ï¼Œå¹¶è¿”å›ä¸€ä¸ªå±€éƒ¨å‡½æ•°<code>nest.&lt;locals&gt;.inner</code>ï¼Œè¿™é‡Œè®°ä½œ<code>[0]inner</code></li>
<li>è¿™ä¸ªå‡½æ•°åˆè¢«ä¼ ç»™<code>[1]nest</code>ï¼Œè€Œè¿™æ¬¡æ‰“å°å‡º<code>id(func)=1921889762848, nest.&lt;locals&gt;.inner</code>ï¼Œä¹Ÿè¿”å›å¦å¤–ä¸€ä¸ªå±€éƒ¨å‡½æ•°å¹¶å°†å…¶èµ‹å€¼ç»™<code>say_hi</code>ï¼Œè¿™ä¸ª<code>say_hi</code>æœ€ç»ˆæŒ‡å‘çš„å‡½æ•°åˆ™è¢«è®°ä½œ<code>[1]inner</code>ï¼Œä¸¤ä¸ªå‡½æ•°é™¤äº†é—­åŒ…çš„<code>func</code>å‡½æ•°æŒ‡å‘çš„å¯¹è±¡ä¸åŒä»¥å¤–å¹¶æ²¡æœ‰ä»»ä½•åŒºåˆ«</li>
<li>æ¥ä¸‹æ¥è¿è¡Œ<code>say_hi(&quot;hi&quot;)</code>ï¼Œæ ¹æ®åˆšæ‰çš„ä¿¡æ¯ï¼Œå¯ä»¥è¢«ç†è§£ä¸º<code>[1]inner(&quot;hi&quot;)</code>ã€‚è€Œåœ¨<code>[1]inner</code>é‡Œï¼Œå…ˆæ‰“å°å‡º<code>[1]nest inner</code>ç„¶åè¿”å›<code>func(func(&quot;hi&quot;))</code>ï¼Œè€Œè¿™ä¸ª<code>func</code>é—­åŒ…æŒ‡å‘çš„æ­£å¼<code>[0]inner</code>å‡½æ•°</li>
<li>ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç†è§£ä¸º<code>[0]inner([0]inner(&quot;hi&quot;))</code>ï¼Œä¸€æ ·çš„å…ˆè¿è¡Œ<code>[0]inner(&quot;hi&quot;)</code>ï¼Œæ‰“å°å‡ºæ¥<code>[1]nest inner</code>ï¼Œç„¶åè¿”å›<code>func(func(&quot;hi&quot;))</code>ï¼Œè¿™æ¬¡<code>func</code>ç»ˆäºæŒ‡å‘äº†åŸå…ˆçš„<code>say_hi</code>å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨åŸä»£ç å¯ä»¥ç†è§£æˆ<code>[0]inner(say_hi(say_hi(&quot;hi&quot;)))</code>ï¼Œä¹Ÿå°±æ˜¯å°†å¥—äº†ä¸¤å±‚çº¿çš„<code>&quot;hi&quot;</code>ä¼ ç»™äº†<code>[0]inner</code></li>
<li>ä¸€æ ·çš„æ“ä½œï¼ŒæŠŠ<code>[0]inner</code>åŒ–ä¸ºä¸¤å±‚<code>say_hi</code>åµŒå¥—ï¼Œä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªè¡¨è¾¾å¼(<code>say_hi(&quot;hi&quot;)</code>)å°±æ˜¯è¢«å¥—äº†å››æ¬¡çº¿çš„<code>&quot;hi&quot;</code></li>
<li>æ‰“å°å‡ºè¿™ä¸€é•¿ä¸²å­—ç¬¦ä¸²</li>
</ol>
<p>è€Œå¦‚æœæˆ‘ä»¬åœ¨åŠ ä¸ŠåµŒå¥—è£…é¥°å™¨ï¼Œå°±å¯ä»¥è®©å¥—çš„çº¿çš„å±‚æ•°æˆæŒ‡æ•°çº§å¢åŠ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">nest</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> func(func(*args, **kwargs))</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="meta">@nest   </span><span class="comment"># 16å±‚çº¿</span></span><br><span class="line"><span class="meta">@nest   </span><span class="comment"># 4å±‚çº¿</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nest</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> func(func(*args, **kwargs))</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line">    </span><br><span class="line"><span class="meta">@nest   </span><span class="comment"># 65536å±‚çº¿</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nest</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> func(func(*args, **kwargs))</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="meta">@nest</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params"><span class="built_in">any</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;----\n<span class="subst">&#123;<span class="built_in">any</span>&#125;</span>\n----&quot;</span></span><br></pre></td></tr></table></figure>
<p>è™½ç„¶æ²¡å•¥ç”¨ï¼Œä½†æ˜¯å¾ˆçƒ§è„‘ï¼Œå¾ˆè¿·æƒ‘ã€‚è§„å¾‹å°±æ˜¯æ¯å¤šä¸€ä¸ªåµŒå¥—è£…é¥°å™¨ï¼Œçº¿çš„å±‚æ•°å°±å¹³æ–¹ï¼›è€Œæ¯å¤šä¸€å±‚ï¼Œçº¿çš„å±‚æ•°å°±ç­‰äº2çš„ç°æœ‰çº¿æ•°æ¬¡æ–¹ï¼Œæ¯”å¦‚è¿™é‡Œå°±æ˜¯ 2^16 ä¹Ÿå°±æ˜¯ 65536 å±‚çº¿ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://www.fdxblog.tk">Fed_Dragon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://www.fdxblog.tk/2022/11/28/Python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/">https://www.fdxblog.tk/2022/11/28/Python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://www.fdxblog.tk" target="_blank">FdxCauponağŸ</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/%E8%A3%85%E9%A5%B0%E5%99%A8/">è£…é¥°å™¨</a><a class="post-meta__tags" href="/tags/functools/">functools</a></div><div class="post_share"><div class="social-share" data-image="/img/cover1.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/03/Python-def%E5%85%B3%E9%94%AE%E5%AD%97%E7%AB%9F%E7%84%B6%E6%98%AF%E8%AF%AD%E6%B3%95%E7%B3%96%EF%BC%9FCode-Object%E8%AF%A6%E8%A7%A3/"><img class="prev-cover" src="/img/cover6.webp" onerror="onerror=null;src='/img/default_cover.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/21/Python-%E6%8F%8F%E8%BF%B0%E5%99%A8%E6%B7%B1%E5%85%A5%E7%AE%80%E5%87%BA/"><img class="next-cover" src="/img/cover5.webp" onerror="onerror=null;src='/img/default_cover.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Python æè¿°å™¨æ·±å…¥ç®€å‡º</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2022/11/21/Python-%E6%8F%8F%E8%BF%B0%E5%99%A8%E6%B7%B1%E5%85%A5%E7%AE%80%E5%87%BA/" title="Python æè¿°å™¨æ·±å…¥ç®€å‡º"><img class="cover" src="/img/cover5.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-21</div><div class="title">Python æè¿°å™¨æ·±å…¥ç®€å‡º</div></div></a></div><div><a href="/2022/11/18/Python-Metaclass%E4%B8%8E%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/" title="Python Metaclasså…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹"><img class="cover" src="/img/cover5.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-19</div><div class="title">Python Metaclasså…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹</div></div></a></div><div><a href="/2022/12/03/Python-def%E5%85%B3%E9%94%AE%E5%AD%97%E7%AB%9F%E7%84%B6%E6%98%AF%E8%AF%AD%E6%B3%95%E7%B3%96%EF%BC%9FCode-Object%E8%AF%A6%E8%A7%A3/" title="Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£"><img class="cover" src="/img/cover6.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-03</div><div class="title">Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Fed_Dragon</div><div class="author-info__description">ä¸€äº›Pythonçš„å°æŠ€å·§å’Œæ•´æ´»</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/509754182"><i class="fa-brands fa-bilibili"></i><span>å…³æ³¨æˆ‘ï¼</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/FedDragon1" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/509754182" target="_blank" title="Bilibili"><i class="fa-brands fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">åšå®¢è¯•è¿è¡Œï¼é¡µé¢å› ä¸ºæ€§èƒ½åŸå› æœ‰å¯èƒ½ä¼šå¡é¡¿<br>ä¸»åŸŸåï¼š<a href="https://www.fdxblog.tk">www.fdxblog.tk</a><br>å¤‡ç”¨åŸŸåï¼š<a target="_blank" rel="noopener" href="https://blog.fdxblog.tk">blog.fdxblog.tk</a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%EF%BC%9F"><span class="toc-number">1.</span> <span class="toc-text">è£…é¥°å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E6%97%B6%E5%87%BD%E6%95%B0%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4"><span class="toc-number">1.1.</span> <span class="toc-text">è®¡æ—¶å‡½æ•°è¿è¡Œæ—¶é—´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E5%87%BD%E6%95%B0%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7"><span class="toc-number">1.2.</span> <span class="toc-text">ç»™å‡½æ•°æ·»åŠ å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E9%AB%98%E7%BA%A7%E7%9A%84%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">æ›´é«˜çº§çš„è£…é¥°å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#functools-wraps%E8%A3%85%E9%A5%B0%E5%99%A8%E8%A3%85%E9%A5%B0%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">2.1.</span> <span class="toc-text">functools.wrapsè£…é¥°å™¨è£…é¥°è£…é¥°å™¨(?)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E8%A3%85%E9%A5%B0%E5%99%A8%E5%B5%8C%E5%A5%97"><span class="toc-number">2.2.</span> <span class="toc-text">å¤šä¸ªè£…é¥°å™¨åµŒå¥—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E4%BC%A0%E5%8F%82"><span class="toc-number">2.3.</span> <span class="toc-text">è£…é¥°å™¨ä¼ å‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%A2%AB%E8%A3%85%E9%A5%B0"><span class="toc-number">2.4.</span> <span class="toc-text">ç±»ä¹Ÿå¯ä»¥è¢«è£…é¥°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%A2%AB%E5%BD%93%E4%BD%9C%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">2.5.</span> <span class="toc-text">ç±»ä¹Ÿå¯ä»¥è¢«å½“ä½œè£…é¥°å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E4%BD%BF%E7%94%A8%E9%89%B4%E8%B5%8F"><span class="toc-number">3.</span> <span class="toc-text">è£…é¥°å™¨ä½¿ç”¨é‰´èµ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E8%A3%85%E9%A5%B0%E8%A3%85%E9%A5%B0%E5%99%A8%E4%B9%8Bfunctools-wraps"><span class="toc-number">3.1.</span> <span class="toc-text">è£…é¥°å™¨è£…é¥°è£…é¥°å™¨ä¹‹functools.wraps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E6%8D%A2%E6%97%B6%E9%97%B4%EF%BC%8Clru-cahce"><span class="toc-number">3.2.</span> <span class="toc-text">ç©ºé—´æ¢æ—¶é—´ï¼Œlru_cahce!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E8%A3%85%E9%A5%B0%E8%A3%85%E9%A5%B0%E5%99%A8%E8%A3%85%E9%A5%B0%E8%A3%85%E9%A5%B0%E5%99%A8%E8%A3%85%E9%A5%B0%E8%A3%85%E9%A5%B0%E5%99%A8%E2%80%A6%E2%80%A6"><span class="toc-number">3.3.</span> <span class="toc-text">è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨è£…é¥°è£…é¥°å™¨â€¦â€¦</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/03/Python-def%E5%85%B3%E9%94%AE%E5%AD%97%E7%AB%9F%E7%84%B6%E6%98%AF%E8%AF%AD%E6%B3%95%E7%B3%96%EF%BC%9FCode-Object%E8%AF%A6%E8%A7%A3/" title="Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£"><img src="/img/cover6.webp" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£"/></a><div class="content"><a class="title" href="/2022/12/03/Python-def%E5%85%B3%E9%94%AE%E5%AD%97%E7%AB%9F%E7%84%B6%E6%98%AF%E8%AF%AD%E6%B3%95%E7%B3%96%EF%BC%9FCode-Object%E8%AF%A6%E8%A7%A3/" title="Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£">Python defå…³é”®å­—ç«Ÿç„¶æ˜¯è¯­æ³•ç³–ï¼ŸCode Objectè¯¦è§£</a><time datetime="2022-12-03T11:27:05.000Z" title="å‘è¡¨äº 2022-12-03 19:27:05">2022-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/28/Python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/" title="Python è£…é¥°å™¨è¯¦è§£"><img src="/img/cover1.webp" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Python è£…é¥°å™¨è¯¦è§£"/></a><div class="content"><a class="title" href="/2022/11/28/Python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/" title="Python è£…é¥°å™¨è¯¦è§£">Python è£…é¥°å™¨è¯¦è§£</a><time datetime="2022-11-28T10:23:30.000Z" title="å‘è¡¨äº 2022-11-28 18:23:30">2022-11-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/21/Python-%E6%8F%8F%E8%BF%B0%E5%99%A8%E6%B7%B1%E5%85%A5%E7%AE%80%E5%87%BA/" title="Python æè¿°å™¨æ·±å…¥ç®€å‡º"><img src="/img/cover5.webp" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Python æè¿°å™¨æ·±å…¥ç®€å‡º"/></a><div class="content"><a class="title" href="/2022/11/21/Python-%E6%8F%8F%E8%BF%B0%E5%99%A8%E6%B7%B1%E5%85%A5%E7%AE%80%E5%87%BA/" title="Python æè¿°å™¨æ·±å…¥ç®€å‡º">Python æè¿°å™¨æ·±å…¥ç®€å‡º</a><time datetime="2022-11-21T08:17:46.000Z" title="å‘è¡¨äº 2022-11-21 16:17:46">2022-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/18/Python-Metaclass%E4%B8%8E%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/" title="Python Metaclasså…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹"><img src="/img/cover5.webp" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Python Metaclasså…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹"/></a><div class="content"><a class="title" href="/2022/11/18/Python-Metaclass%E4%B8%8E%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/" title="Python Metaclasså…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹">Python Metaclasså…ƒç±»ä¸ä½¿ç”¨æ¡ˆä¾‹</a><time datetime="2022-11-19T03:48:32.000Z" title="å‘è¡¨äº 2022-11-19 11:48:32">2022-11-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Fed_Dragon</div><div class="footer_custom_text"></div><div id="footer_site_ontime"><p id="ontime_value">2022/10/29</p></div><div class="framework-info"><a target="_blank" rel="noopener" href="https://hexo.io"><img src="https://img.shields.io/badge/Framework-Hexo-83855d?style=flat&amp;logo=Hexo" alt="Framework: Hexo;"/></a><a target="_blank" rel="noopener" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-83855d?style=flat&amp;logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIy0lEQVR42u2bdXjbShbFs8y8%2B88yMzMzMxVMMZTrKEyPw4%2BfU2ZmBttlbh8zMzPaLtetPTu%2FzytVcSJbkpWH%2FuN%2B32junXvPOYK5kpMKIcRr2soClAUoC%2FCaF6AsQFmAMZ3Rz%2Flb58f8DdNuDrTO3xhsW9UY7Fr%2FsVcLSbjACW5whCucBQKEzl2luP%2FuEu7f%2FyXP%2Fio8%2F%2FAKr6f%2BpG9szwv%2Bc1Zc%2FEohDFYwgx0OcMnnB2e4V3h9DWkmzJh3eDgTaJm7ZUjb7ne%2B3EiDCWxgNMsH7hXuvwzhwJKhqr9u8p2h82OffqmJgwEsYLLKA%2B4VnmHjs%2F0cf5CX%2F39GCm%2FgbOFx1UjCvoGF%2BHcwGzx31RkvFXlqg2EgbGAGOxzgAqf8GLhXBBqmPKlN%2FnWo8DUvEf5pjwr%2FrGf7WGXkduGrmy2Tjeib6I%2F%2FEP766Te82OSpSW0dFrCBEaz5%2BOEENzhq8XCvGH3hmnM48LprhX%2FKQwQXtcoLrxaeytY%2BxX3Bs46N7oh%2FbbCJU4Na%2BtpgAZMZ7HCEK%2BvgXhHYLd7qDzamldWPidHLnifItFV27hKeIWN0t0QoG%2BqM%2FXawyJObGmo9aoPBCmY4whXOcK8gcc26Z6dWx5ICC69NiODc58wnnfm08NbO0rYaz39HZkf3xH%2FgNHlyklvdoqlJbbM44QQ3lSectUaoOpb4lerAlGhSjFpi8Wro2C7UHcU7bFzGyduBXORUn9zUsoINLnDSc4SzJsCQleINcvJZHHobt%2FoFEZhjQYTIbewMORFcVafUbku1SGdkz4SuCf8yIoqPGP0cOchFTnJTwywesMMhnxdc4awJgMnJ2TjzTdmYFCMWPmdehAl3Cc%2B%2F%2FLkH44hzD%2BcT7O3qTU3qmfTFfPLM4csXiBzkIie5zeIAM9gH4gRXcvcVIJr6M04jG7viBeGfbVKE3juE55%2B53kH23Rv0hCTJiLRd%2BQIwh08%2Fx1pykIucZmqDEayFuMC1nwDKJvEW6cwUWli1PiFC858zJ8IlNwr3n%2F4p3H8bLoIXxH6s1pkxY8abJNH75Jn%2BqTrHmDl86hxrWEsOcpmoCTYwFiQPR7j2EwBT4slHCCqsXlKMWW7uavC1LNN6BH2dSFfEJQlvU48Z93b3evUx6l5PDjNnHUxgK4YfjobfA6pjqf0EmTGUNvNs8PjPzN0KLfO26mq9TpK%2Bubej9weYHN%2FW1tb2etVPLGtYa%2BZeB4tZ3HAsIEBisflE2k5RuG%2BY%2FACvnrSggkZGdxXUSuJxTI7r9c0OsaxhbaF9ndpW8cLRUAAlluy2mFDrG0Yvfb5gx0jz4gu0HtcEOD%2FySUk%2BK01M6pz0KXWeGGILdXjUoqYdrHA0vgLiyZEE2bXwOuOHpHd85P%2B7woK12tn%2Bd%2BgZTD3GRwyxRg85apSCEY5GAmgdYak2dtUAt8XUh%2BniBB0dtf7147989fff%2Fr3AGDOHjxhi8y93cjqBDY6GAtSvf%2F5jBDliUSnEyr6dpK9%2Bbu419MzFS1y%2F%2B%2FMNf%2FjO7wXGmDl8xOg7OXKQyylccDQSgIPXyaBjBDplCtvmCoTIvZOzt3vd1WnIDvnVnwXGmDl8xBDLGtY6iQVucDQQQHsO7CHYaYMMr6K%2B5kXCO2RUv%2B92zOEjRiPusMGt6O8CSizxb4IHyU4p655NVI5pP5QvAHP4iBms%2BnArKgBWE010ygUn7BSp2XxQ1G09LOp3HBUNu46Lxr1p0bz%2FpGi5IiNarxICGz9xq548xpzmJ5Y1rCUHuchJbpvkT8DJ0i9D41c%2B886a%2BMG%2FVsdT4ZpY8kx5%2BVworUc%2BkJplOzmmdsuhsAR3J0CbL89I0FnAF7WmfSfFuIvX5QvAHD5TOahFTWqDASxgAhsYwQpmsMMBLo7%2BNNa4J72o5cpsFjBWrVaexfCUHcLz539q5Bkzh89OTrCAadB%2FG6zbefQjTftPPUJRO9a4%2B3juPWLiJjEqfI7w%2FvU%2FAmPMHD5i7OYHGxgHRYCGPUddzVdk0nbBtchLtiaeyglwySoR7pglwu0zMcbM4SOGWNsigBGsjgog78321iuztkGxVt6np1vmngWQ1htzmp%2FYUuuB2REBGnan%2FS0lgMHqth%2BBWM42PgfhgQyfFseaUmqCGewlC9B8IHOYhCXe95opK%2B43FACfFlvi8wADe0kCNO48FiyJ%2FN50%2F2Zk9lWGAuDLjydHKRjgYFuApt3HGx0685pV9W7U3fcLM5h6jE%2BLdehKgIN9AfYcV%2BwUbdh5zOAN8QUR7porNMIXrziMqcf4iBloLTntYIGDbQEadh8babEgbatxL778PohqVhVZ%2FyimmyPGcD25reKBg20BlE3i3aY7viuFqNt2pPDLyOwr%2Bwowaes6TDdHTKEc1KCW6Q4RDiXtAk170zea6c1rtx4u%2FiU5sqGvADP2DMF0c8QUy0MtU%2B8eYC95G2zcdeQfxZ70NZtShUFjG5%2FnHtc3PllZ4PUYY91zgNii%2BahZbIcAuyOdYPO%2B9C39z3pGXo6Hzb%2BLL7lDf%2Fbp%2Fa9X8zPW%2BYg1nRcMYMnHB2bHWuGG3Qc%2FKF8%2F06e3uBOiOtfXm7aqyduERrJztqiZcUD7aYwxc6qfWAu5wQImjTxYweyUANqO0Lj3RNbWRwm2v%2B75pwleuv7x%2FPzMqX5iWWPnYwwYwer863AJ3wuVpXf1vfyn7xqfn5s5fQxrSvzu57wANdFUlR1QVfJjh0bu0rXPGuXHp8axxk4tMA7eB5EtqffLIk9Zu%2FwTudffzjmiakLs9sC8G99rlB8fMcSyhrVWaoENjIMlgP4PKU6ZvvyX3S3o9pRpe79ltgaxrGGtlS%2FOYHtR%2Flxe2Zj4hdkrQVl869a2tt1vtFqDNaw1e%2BbB9KL%2Bv4ASTX1fFk4XvB9jyaltbeL1dmuwlhxFyKfB8pL8w4QST7kkgAcM9ubziHHCyGVA%2FgEwvKT%2FMcJZUjYd%2BlB47cEP1EYTv%2BT7vBJNfAOfk0ZOclODWtSkdvlfZsoClAUoC1AWoCxAWQDb9j9N63hK2EtncwAAAABJRU5ErkJggg%3D%3D" alt="Theme: Butterfly;"/></a><a target="_blank" rel="noopener" href="https://vercel.com/dashboard"><img src="https://img.shields.io/badge/Host%20By-Vercel-83855d?style=flat&amp;logo=Vercel" alt="Hosted By: Vercel"/></a><a target="_blank" rel="noopener" href="https://dashboard.4everland.org"><img src="https://img.shields.io/badge/Host%20By-4everland-83855d?style=flat&amp;logo=image%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAMIUlEQVR42u2aW6xc11nHf2vt69zPzcfH8QU7J3Ecx5c4OEkTRCgIKhpVQUFBRVDRB64KttIGIiRAgj4hkbQVt0rwglKQqj60aROQlTaECEMoTus6SW1iu3Z8Ofa5zpkzlz37vhYPa2%2BfU4mHgOI2UWakpT2zZ885%2B%2Fut7%2FL%2FvhmhteaD%2FJB8wB8jACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAH8CHTQey45ACuYbMgkxBGoH2wHYhz8CqQtwHbxyiIWQJYEGagnRBOhAOABtyBQoQNkQKvDFzfphzsDNgd6XJR9sDEC7kEtZi8DxYGHJeSY7PjPHaW23i5Ri0gGFurtkxBhc7MFYBIeD8GkxVzTW2hDCDxSEcmIaVEBoeaAVni%2BvunYFvXoUxHxLgYg%2Fsm07Yhjzh1iDgiFXjt5otak4FmuPmxjNgqzY3b7kwSOFqh1e7MU97Nl9L1PswBLQGATgODHv8WbfHeWXzaelS86vm%2FTCCQQTD4hilZmfGK1B3eFAonrvS4VtJzkHfNp%2B5OSFwM%2F6oC0nA7FrEP0WCPbVxcOuQA1kOuQANSGGuF4VxeQ5Sw5YG1D3IF7h%2FbsCpXs5TEzWeseX7wAMsAemQ3wsyTic%2Be8a2glczBiPNUWBiuFyWAHvDaynAd%2BC%2BrXBgCjx4eqnPP6%2BEbHffZW94VwAICbYDKA4Merw6SHnGmsBrbDKJMNdmURiPAGmBlGBJ87w03BEYShpQsKMJP7MDtvg8fKnNuZUhj9c9cCQo%2FaMGIMCyIA%2BpB2s8Oxjyeih4wN0MXsOAMdtt%2FpMqYLF%2Bav1YeIIQYGEMtC3jGQ0XHtgKsw38OOZvFvp8b2HIz3vWehj9cHOAMLsnNGNpwpEg5GgkmKYC1QkQPmi5bqGwzE7nxcbK4rwW6zAsYXZUCnAs4%2BZlAVCY9w7PmM9e6HJXAseweC5RfN61OW7JwrtuNgDLBTlkUxJzNEo4EsG4roErjVaQTVB5AcAy1ilhXktRxK80xmux7gH2hvwgAZ0ZcFIar6AIkT2T5oIog7mARzsBj9o2z49V%2BQsteFmK%2FxuIdwRACLBskHBHsMxnhwE%2FG4FH1WRt5Rgwwi9ygWtiXlEYr424UsU5XQglXe5uIcLyDUchwCm8xZFQcSFVsNOG5dCIo5YPwwze7vHIfJdHbIdXMs3T0uIbtiSzCsj6%2FwWgTEaCmUzxq8ESn4pStkUx6Ao4DYhjzlQbjDk%2BZ4OYMWuCdnuOL3cHKFyE7Zkk6Hrg%2BuAWoCx7QxiUClRBkhtBFETQi6ETwiCBfgLdGJQku38Hh3e1%2BMiJeTrbm2w900He2mTaltinVviw1Hz4%2FDKDQc7f3znJV5XmFVe%2BUwCi2B3BeB7xMWGxL%2BlzJBuyaNc512gwP9XitJzgerLCC3qImN7PPrfOZP9N3m77fPlKBt2OCQdfgfSMV1gWuK6B4TgmwZUpONeQ5satSSAtjlEKvcjI2sUBSBuaNs%2FOKdy4xtHLmnzNZalRRQ4zfmrbJi7Ymtlhxq%2F3%2Bzz%2B5gofSxSnGw7frlgcq1icuKE%2FdAlAGh%2FUOVUFHxWST9gpY%2F40E26NTCU8K6f4c8%2FmgHBQeOxFMNR1mqLOQ8CyusDZxhYWKhZcrcCiBeOF0WUMaw1KGbEjingvs1yujXtnedFHFDdnSZMQfRtqLjQsWMlg2xTJdwOa3Zj88BaWrwU4fcW3Dt1C78qAwW0VPnMPrL54hXoYcuhSyIH5mMNVj7vynC%2F2Ep6XNicFIHRH17OT%2FGGueByPqpSELPLHzp2sodlPk2VWOZ2vcp8UrNJgQQeMiSa36oxrtIjUeV4kZ96ukQYRvLACsQ2tCmgb6g1ojYHvGy9wXANHiB8EEGcQJNAfwlIAlzuwFhn3z2K4asN8FaZ9ON3msUmfMMzp7x%2Fnx2PF9bWYbGeD3eMec%2Bd6eNtqbG6HnDjVJmw4bLXgk0Jz10wVqeDYfy7xJyI%2FqZ9Xb%2FKyvJ0LYoigRpuAVPfZzhgdeYix%2FF%2BJyVkiZkrsoUOXKruYEYoIB0dd5iJtLiFZtjyIczgWgqxArQqWY5ZfJMkyJDbmgBJAmEI%2Fgm5k8sFaBP0AvpvAGQ%2BszHSnkz6%2FEWRcSxWJ0ogwZ9CPcXc0YJAiBil116KjNNmkzxSC4U9uZvL7PRYqFjuvB9z7RpuXbWzO4bMPjwkUi0KQakjJiYWL1BewGLJGFYmHJWyaTFFVJzmvJ5iSd1NFo8mLqFLQt6DWBL8KM5thdQ1OXzRJLs1NC5wVnWBZAVIMhBRzfvsU3LsLlgOY70A7gCsprOWmzCoFaU6eKFKlafgWYeaQVm3qlsDKNXbdYWItoe9IeklO35bM3DPFvpUQ%2B5tXuX54Ez9hyzv4fa3466zLH6gESyjmLc28vZuv4LCkV2iIaU6KOo%2BJhJ62UGimCOhoG1v3sXWfATUGdh2ur8K%2FpdBqgFTmRrWGLIM4NbucCbNS1ktfCSAXoKTJBbk2eSFQsA24M4IrddhWg%2BNzrO6dpBFlcL5HfXcT3fIZn%2FTZO%2BlyeT6ifrZDtx1younw8ck6B08scs%2FWCoeUZn5Pk2dvbfKPdpGIjqiQI0mfX1AeH9ewX1ziCafJFgHHtUZ7iqp0eVMO2U0NZd1FhYQH6DNHi0Nyih3K4hsnV8DW4JaSvkxoljmvitouhSkCJQCJAZZhIJSiqRRHXQXNHB4dh9ldYEvu7ycED22lP9tnuWmxH%2FjeYsjcpR6eL1jMUh704BNRxIdCjbU64JX5Hk%2FsaPHizgZnFWCXikTYIF2%2Brut8PVmDuM2dFjyZhXxEaf5ShyAdLhNwypnhat1j33CVxfoE1Gf56e7rHP9OD7oBtJpm51y9XglytWEVRub8oPjJSgBFVXaKRJkVoTNU8O9n4dUl2HMLjYHEe%2B0K0cFJ7tCa%2B04usrMXIzsxvwSMS0F3h8%2Frec6nOyFfazosRMCYZ8Kx9r8KIWVu2K7z38LiNy0JXotPBsv84jDnkVDyY%2BoK2HVIchb8izhenUZfcHfWYu8tVVzcG4JHxDFuHPOKY%2FOGMk5wQ9qWequcB1A0RFqilMbvRfyy0tTqPonCCCkByVAzO%2Bxw37TPlktDhm9FjCUarvUKmaw5t73JX2XwpVzx1uYaLMcm%2FEQB%2FIbO04EmPwdZG9IA8hqkA0iHIJpGk7vjEK%2BAVWU2zTg6HHI0iJFUQVugLGOwPw5UTdyrQt2leVHurXXZW%2FYBN16XHqDXJXSqzKJol8tq4dvw6jxcGxiQQQrneyaHTNX5j6bP5%2BYGfHVHw%2BiIhQAmfOhnEGTmuu1NEArGq%2B%2BkF9BGHeYKhOSC2%2BRTbpPP10Ke6HZ4dDBgp%2FYNqKjcTV2AKWJZWuvDEIrGiA06vZwXpArScnYgTblLtBnAxkX%2F8FYHrg5gmMDFvhFVt7T4l9sm%2BGyiOdaJCvBqvZt897pBbW5Kay5XN%2FNkmvGkgKdyiz8ahLSSBFzLyGCtjaFKGoBaGC%2FQhdy%2B0REWO1%2FueI7REYky5xNlVlz0CmdWYG4AqYDpJsdmJ%2Fhcy%2BOlmg3nu8bjxA9jIJKnRrM7FZ5ujDNblXzGSiBcgnhgfFsok9G0Wr8ptaE0lksVK9fG08pzaWF0rIyrn5g3o%2BxAc6xe4aHdkzzcdHmpF0OU%2FwgmQoIb%2Br4tLf50rMXdTZuX8jaEa8ZwWQxPwAgYCqNL3Z8X%2FUGujDekxc6XoaGAdmiMfzsgmmzw2%2BMVHnYEx6PMAHpPDEWV6SJfb03zc60Kv6M7JP1FyBOT2SmmPWVjVILYOA9QRdDemBsA3%2B%2FAtxdgNeMrt0%2Bxe6rC3%2BkNM8b33FQ40%2BBW%2BdtGhdvp8V%2FBEkQDkxxFUX4sud4IlSDkhqSoi%2Bx%2BahFOLkMIv7JrnMdcwdUyXN67X4xo49KZ5sqmGT5UkTzVu85c2C00xsap74anpT7Qwrj8d%2BbhzCr%2FsHeGgxMVvhSm6yXzffHlqBCmxrg%2Bz1hwWxbyu%2BGAN%2BLQKLxS6pZTXcuCYQoLfZau9%2FliJ%2BFA3eXXGg5vCN5ZSXvPfDN0wxmKjI8kdj2%2BECZ8gZwH51bYWWtwaGqKQ0ECmab%2F2kWea9SJIs0LrkVYdyCOTVLUN3GnxOjn8qMfSIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjAB80B7%2FA4t1%2F6lyzbV6AAAAAElFTkSuQmCC" alt="Hosted By: 4EVERLAND"/></a><a target="_blank" rel="noopener" href="https://github.com/FedDragon1/FedDragon1.github.io"><img src="https://img.shields.io/badge/Source-Github-83855d?style=flat&amp;logo=github" alt="Source: Github"/></a><a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-83855d?style=flat&amp;logo=image%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAHwAAAB8CAMAAACcwCSMAAAAMFBMVEX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F9Or7hAAAAAD3RSTlMAESIzRFVmd4iZqrvM3e5GKvWZAAAE5UlEQVR42u1b24KFJgwUCBhAwv9%2Fbe%2FteoKMskjv87jLYUgYYhJxG4fzHHOuJ%2BTM7N22GDbwUbvIHMwqZsel3uJgt4A5Sn2I8jJ%2FOOoQjtf8b1jqMITNUur19EFRj9HPyeyoUyh%2BwuN1GsksNxtAvmX8Ds9SZuZAROSZOecKEIeNN7HLy8G1463n3P2FG%2BO21y6X6IEZxkd5wfXucpL0YA5%2F7bH9OTddcAvbmagUn3KH2XAVZJgdcLOZj8nRfIs7220YNrXTPNjvxuNALAhehj3vBBzSMZg0yG4FjJ8PkgwXewydz%2FEzG8Bg5SjRY6cfTtLfRAYjAUZ8WQwW%2Bjw3Yk%2BdYaXhXsHu8YbPcyN2sVsL3yxwEXu6dXp4tdyRG7t4IrYMxuzShLbPmPp2tbnDQJegJuaRP%2BY3wC9hex1G%2BqZnJcf34bumu7VOV%2FYp06P%2BxwJYJXjw9wXgRlbtn2kJs9bc8cefC07zlphutRCXGq5MZy23ZTsOiORRfLFEwRPBc%2BiIdiIyTwTvGq9Lx2F7li9V7O5y5j2f4tRu7846N87gy2ljVci%2BsbkZkwhXQ0ej9SubLqvObGH3plOdmXqCUaG1tNQmo14L7t6IQ6maV49ahimQQugkKog9KLLYel1zY3aruBG7VeGsIK3nCiAOrK%2BTE50Hf2ogPWmHacFyheB%2BnLEfOQzD9KOwJwpZ5aEq%2BWMi2j98YbubTtsO4jpftUboj6lLUKZIaKrTrOZ0H7aeCQwwPGgRlqAVJE5XAZk2jQ%2Fy3D%2FlviMHK79RK1XsykLdc9aKy2fyvCFxnMBfnfTu2rmE7QKffKVfphSl6y%2BYSy92hnR1JOrXvUDMD%2BogGk5nADmeuJXFNkUe%2BuT2iRMfIXTICawRkI9lnvR3Iv%2BfHAjOvSY4P37U%2FIOpzJvn3A4GGT9OLv3wKt1njqM2vOqfe3tPDh4sqWtWrtG2aZFVz%2BN4RZ87TzUBwag02VW02pDUrDxaSA6TCdWZ06lytKqhEtqFRwuSCZhGxcv3wbuc2dpWi6pgPFAxSiCtfpdJRHxOtW3TXGQi8izdBrv%2F0JFBXQmuEDtK7e%2FDpsNFAy4IEixYWmfqpaoDRbBf3ClGCHBHkLxmUCgCdlUIhefcWmGoRAblb3ywwh3Gt6BbMu7htQ3xoIgH7yKLjipR26Nh4%2F0LbdL0l2m7a9oiQbeDW9hTQ6hE3xvzxRzd7VOF2ygKW2E%2BEJmbVlgAY652OC1vAoInVdCmr0K5OtWy3PTWSIc74UsNPzrNfvNnGB5Wv%2BYAfQ4xvTdbbn2rn7v9tmMBtbLP6n8tdbwp4GmXljpeqUosTNfMSqVXxulafpfb4Usb%2BuV9XPzyHt8V4bXXFjRUyhDWXtjAjq9h9VUVJYsF7FZxx6e3uPhlreHbGFGxx7fvaYvD%2B%2FPmtRG%2Bqdyw6KrQxHZnzR3G9mhi473gCuYRe6FvmZ1w5YbZp%2B5pbyyQG7BPf58QCq7UMfsEvaIejliu1G%2FftLbK4WNXOUE7JIcb801I%2BH3u3MX%2BtHftt4p5IlTttQdJTFatlTiVx02h8Y3XKDnzL8j5WPA5h%2BqHrP6QRYPKgq9Y1n81Nf5FAG4GjSPa%2BTwoLabGcHExNYblIekVfrnc8k%2B9L5FWtBZClHub%2FbYMbu%2BH0RKD3VbD0M45y4k1Jw7f8fWPsLFGZr3MQTIAAAAASUVORK5CYII%3D" alt="Copyright: BY-NC-SA 4.0"/></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script type="text/javascript" src="https://yijuzhan.com/api/word.php?m=js"></script><script>document.getElementsByClassName("footer_custom_text")[0].innerHTML = `${str[0]} â€”â€” ${str[1]}`</script><script>let element=document.getElementById("footer_site_ontime"),startDate=new Date(element.innerText);function getTimeDelta(){let t=new Date,n=new Date(t-startDate),e=n.getFullYear()-1970,p=n.getMonth(),s=n.getDate()-1,a=n.getHours(),r;return[e,p,s,a,n.getMinutes(),n.getSeconds()]}function displayTimeDelta(){let t=getTimeDelta(),n;n=0===t[1]?`æœ¬ç«™å·²ç»è¿è¡Œäº† ${t[2].toString().padStart(2,"0")} å¤© ${t[3].toString().padStart(2,"0")} å°æ—¶ ${t[4].toString().padStart(2,"0")} åˆ†é’Ÿ ${t[5].toString().padStart(2,"0")} ç§’â¤`:0===t[0]?`æœ¬ç«™å·²ç»è¿è¡Œäº† ${t[1]} æœˆ ${t[2].toString().padStart(2,"0")} å¤© ${t[3].toString().padStart(2,"0")} å°æ—¶ ${t[4].toString().padStart(2,"0")} åˆ†é’Ÿ ${t[5].toString().padStart(2,"0")} ç§’â¤`:`æœ¬ç«™å·²ç»è¿è¡Œäº† ${t[0]} å¹´ ${t[1]} æœˆ ${t[2].toString().padStart(2,"0")} å¤© ${t[3].toString().padStart(2,"0")} å°æ—¶ ${t[4].toString().padStart(2,"0")} åˆ†é’Ÿ ${t[5].toString().padStart(2,"0")} ç§’â¤`,element.innerText=n}function startCountDown(){displayTimeDelta(),setTimeout(startCountDown,1e3)}startCountDown();</script><script id="canvas_nest" defer="defer" color="131, 133, 93" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>